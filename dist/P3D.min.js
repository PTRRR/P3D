!function t(e,n,r){function o(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return o(n||t)},c,c.exports,t,e,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Axis=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement"),u=t("./Geometry"),l=t("./Material"),c=t("./Mesh"),f=t("./BufferAttribute");n.Axis=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),i=[0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,1],a=[0,1,2,3,4,5],s=[1,0,0,1,1,0,0,1,0,1,0,1,0,1,0,1,0,0,1,1,0,0,1,1];n._material=new l.Material({context:n._context,shaderUrl:"./shaders/line",transparent:!1,drawMode:n._context.LINES,zIndex:1}),n._geometry=new u.Geometry({context:n._context});var h=new f.BufferAttribute({context:n._context,name:"position",data:new Float32Array(i)}),d=new f.BufferAttribute({context:n._context,name:"color",data:new Float32Array(s)}),m=new f.BufferAttribute({context:n._context,name:"index",data:new Uint16Array(a)});return n._geometry.addBufferAttribute(h),n._geometry.addBufferAttribute(d),n._geometry.addBufferAttribute(m),n._mesh=new c.Mesh({context:n._context,geometry:n._geometry,material:n._material,name:t.name}),n}return i(e,t),a(e,[{key:"mesh",get:function(){return this._mesh}}]),e}(s.WebGlElement)},{"./BufferAttribute":3,"./Geometry":6,"./Material":9,"./Mesh":11,"./WebGlElement":24}],2:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Buffer=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement");n.Buffer=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._type="Buffer",n.bufferType=t.bufferType||n._context.ARRAY_BUFFER,n.buffer=n._context.createBuffer(),n}return i(e,t),a(e,[{key:"bind",value:function(){this._context.bindBuffer(this.bufferType,this.buffer)}},{key:"unbind",value:function(){this._context.bindBuffer(this.bufferType,null)}},{key:"setData",value:function(t,e){this._context.bufferData(this.bufferType,t,e)}},{key:"bufferType",set:function(t){this._bufferType=t},get:function(){return this._bufferType}}]),e}(s.WebGlElement)},{"./WebGlElement":24}],3:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.BufferAttribute=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement"),u=t("./Buffer");n.BufferAttribute=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.name=t.name,n.buffer=t.buffer||new u.Buffer(t),n.bufferType=t.bufferType,n.usageParameter=t.usageParameter,n.attributeLocation=t.attributeLocation,n.numberOfElements=t.numberOfElements,n.dataType=t.dataType,n.normalisedElements=t.normalisedElements,n.sizeOfIndividualVertex=t.sizeOfIndividualVertex,n.offsetFromBeginingVertex=t.offsetFromBeginingVertex,n.dataUpdated=!1,n.data=t.data||null,n}return i(e,t),a(e,[{key:"getDefaultAttributeVariables",value:function(){var t={};switch(this._name){case"position":t.bufferType=this._context.ARRAY_BUFFER,t.attributeLocation=0,t.numberOfElements=3,t.normalisedElements=this._context.FALSE,t.sizeOfIndividualVertex=3,t.offsetFromBeginingVertex=0;break;case"texCoord":t.bufferType=this._context.ARRAY_BUFFER,t.attributeLocation=1,t.numberOfElements=2,t.normalisedElements=this._context.FALSE,t.sizeOfIndividualVertex=2,t.offsetFromBeginingVertex=0;break;case"normal":t.bufferType=this._context.ARRAY_BUFFER,t.attributeLocation=2,t.numberOfElements=3,t.normalisedElements=this._context.TRUE,t.sizeOfIndividualVertex=3,t.offsetFromBeginingVertex=0;break;case"color":t.bufferType=this._context.ARRAY_BUFFER,t.attributeLocation=3,t.numberOfElements=4,t.normalisedElements=this._context.FALSE,t.sizeOfIndividualVertex=4,t.offsetFromBeginingVertex=0;break;case"index":this.buffer.bufferType=this._context.ELEMENT_ARRAY_BUFFER;break;default:this.buffer.bufferType=this._context.ARRAY_BUFFER}return this._data instanceof Float32Array?t.dataType=this._context.FLOAT:this._data instanceof Uint16Array&&(t.dataType=this._context.INT),t}},{key:"setData",value:function(t,e){this._usageParameter=e,this.data=t}},{key:"bind",value:function(){if(this._context.boundProgram)if(void 0!==this._attributeLocation){var t=null;this._data instanceof Float32Array?t=Float32Array.BYTES_PER_ELEMENT:this._data instanceof Uint16Array&&(t=Uint16Array.BYTES_PER_ELEMENT),this.buffer.bind(),this._context.enableVertexAttribArray(this._attributeLocation),this._context.vertexAttribPointer(this._attributeLocation,this._numberOfElements,this._dataType,this._normalisedElements,this._sizeOfIndividualVertex*t,this._offsetFromBeginingVertex*t),this.buffer.unbind()}else this._attributeLocation=this._context.getAttribLocation(this._context.boundProgram,this.name);else console.error(this.constructor.name+" ERROR: no program is bound yet, can't find the attribute location for: "+this.name)}},{key:"name",set:function(t){this._name=t},get:function(){return this._name}},{key:"buffer",set:function(t){"Buffer"==t.type?this._buffer=t:console.error("You must pass a valid buffer object!")},get:function(){return this._buffer}},{key:"bufferType",set:function(t){this._bufferType=t},get:function(){return this._bufferType}},{key:"usageParameter",set:function(t){this._usageParameter=t},get:function(){return this._usageParameter}},{key:"attributeLocation",set:function(t){this._attributeLocation=t},get:function(){return this._attributeLocation}},{key:"numberOfElements",set:function(t){this._numberOfElements=t},get:function(){return this._numberOfElements}},{key:"dataType",set:function(t){this._dataType=t},get:function(){return this._dataType}},{key:"normalisedElements",set:function(t){this._normalisedElements=t},get:function(){return this._normalisedElements}},{key:"sizeOfIndividualVertex",set:function(t){this._sizeOfIndividualVertex=t},get:function(){return this._sizeOfIndividualVertex}},{key:"offsetFromBeginingVertex",set:function(t){this._offsetFromBeginingVertex=t},get:function(){return this._offsetFromBeginingVertex}},{key:"data",set:function(t){if(null!=t)if(t instanceof Float32Array||t instanceof Uint16Array)if(this._name){this.dataUpdated=!0,this._data=t;var e=this.getDefaultAttributeVariables();this._bufferType||(this._bufferType=e.bufferType),this._dataType||(this._dataType=e.dataType),this._usageParameter||(this._usageParameter=this._context.STATIC_DRAW),this._attributeLocation||(this._attributeLocation=e.attributeLocation),this._numberOfElements||(this._numberOfElements=e.numberOfElements),this._normalisedElements||(this._normalisedElements=e.normalisedElements),this._sizeOfIndividualVertex||(this._sizeOfIndividualVertex=e.sizeOfIndividualVertex),this._offsetFromBeginingVertex||(this._offsetFromBeginingVertex=e.offsetFromBeginingVertex),this.buffer.bind(),this.buffer.setData(this._data,this._usageParameter),this.buffer.unbind()}else console.error(this.constructor.name+" ERROR: you must specify a name! ");else console.error(this.constructor.name+" ERROR: the data must be a Float32Array of Uint16Array! ")},get:function(){return this._data}}]),e}(s.WebGlElement)},{"./Buffer":2,"./WebGlElement":24}],4:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Camera=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=function t(e,n,r,o){var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var a=Object.getPrototypeOf(e);null!==a&&t(a,n,r,o)}else if("value"in i&&i.writable)i.value=r;else{var s=i.set;void 0!==s&&s.call(o,r)}return r},l=t("./Transform");n.Camera=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._direction=[0,0,1],n._vMatrix=mat4.create(),mat4.identity(n._vMatrix),n._pMatrix=mat4.create(),mat4.identity(n._pMatrix),n.farClipPlane=t.farClipPlane,n.nearClipPlane=t.nearClipPlane,n}return i(e,t),a(e,[{key:"lookAt",value:function(t){mat4.lookAt(this._vMatrix,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"position",this),t,[0,1,0]),vec3.subtract(this._direction,t,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"position",this)),vec3.normalize(this._direction,this._direction)}},{key:"update",value:function(){var t=vec3.create();vec3.add(t,s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"position",this),this._direction),this.lookAt(t)}},{key:"get2DPoint",value:function(t){var e=mat4.mul(mat4.create(),this.pMatrix,this.vMatrix),n=vec3.transformMat4(vec3.create(),t,e),r=vec2.create();return r[0]=(n[0]+1)/2*this._context.renderer.realWidth,r[1]=(1-n[1])/2*this._context.renderer.realHeight,r}},{key:"position",set:function(t){t&&u(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"position",t,this)},get:function(){return s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"position",this)}},{key:"vMatrix",set:function(t){this._vMatrix=t},get:function(){return this._vMatrix}},{key:"pMatrix",set:function(t){this._pMatrix=t},get:function(){return this._pMatrix}},{key:"nearClipPlane",set:function(t){this._nearClipPlane=t},get:function(){return this._nearClipPlane}},{key:"farClipPlane",set:function(t){this._farClipPlane=t},get:function(){return this._farClipPlane}}]),e}(l.Transform)},{"./Transform":23}],5:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Fbo=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement"),u=t("./Texture");n.Fbo=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._width=t.width||512,n._height=t.height||512,n._lastViewPort=null,n._frameTexture=new u.Texture({context:n._context,width:n._width,height:n._height,minFilter:t.minFilter,maxFilter:t.maxFilter}),n._renderBuffer=n._context.createRenderbuffer(),n._context.bindRenderbuffer(n._context.RENDERBUFFER,n._renderBuffer),n._context.renderbufferStorage(n._context.RENDERBUFFER,n._context.DEPTH_COMPONENT16,n._width,n._height),n._frameBuffer=n._context.createFramebuffer(),n._context.bindFramebuffer(n._context.FRAMEBUFFER,n._frameBuffer),n._context.framebufferTexture2D(n._context.FRAMEBUFFER,n._context.COLOR_ATTACHMENT0,n._context.TEXTURE_2D,n._frameTexture.texture,0),n._context.framebufferRenderbuffer(n._context.FRAMEBUFFER,n._context.DEPTH_ATTACHMENT,n._context.RENDERBUFFER,n._renderBuffer),n._context.bindRenderbuffer(n._context.RENDERBUFFER,null),n._context.bindFramebuffer(n._context.FRAMEBUFFER,null),n}return i(e,t),a(e,[{key:"bind",value:function(){this._lastViewPort=this._context.renderer.viewport,this._context.viewport(0,0,this._width,this._height),this._context.bindFramebuffer(this._context.FRAMEBUFFER,this._frameBuffer)}},{key:"unbind",value:function(){this._context.viewport(this._lastViewPort.x,this._lastViewPort.y,this._lastViewPort.width,this._lastViewPort.height),this._context.bindFramebuffer(this._context.FRAMEBUFFER,null)}},{key:"texture",get:function(){return this._frameTexture}}]),e}(s.WebGlElement)},{"./Texture":22,"./WebGlElement":24}],6:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Geometry=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement");t("./BufferAttribute"),n.Geometry=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._bufferAttributes={},n._vao=null,n}return i(e,t),a(e,[{key:"addBufferAttribute",value:function(t){"BufferAttribute"==t.type?this._bufferAttributes[t.name]=t:console.error(this.constructor.name+" Geometry ERROR: You must pass a valid attribute to the geometry.")}},{key:"deleteBufferAttribute",value:function(t){"BufferAttribute"==t.type?(console.log(t.name+" deleted"),this._context.deleteBuffer(t.buffer)):console.error(this.constructor.name+" Geometry ERROR: You must pass a valid attribute to the geometry.")}},{key:"clone",value:function(){var t=new e({context:this._context});return this.bufferAttributes.position&&t.addBufferAttribute(this.bufferAttributes.position),this.bufferAttributes.color&&t.addBufferAttribute(this.bufferAttributes.color),this.bufferAttributes.texCoord&&t.addBufferAttribute(this.bufferAttributes.texCoord),this.bufferAttributes.normal&&t.addBufferAttribute(this.bufferAttributes.normal),this.bufferAttributes.index&&t.addBufferAttribute(this.bufferAttributes.index),t}},{key:"bind",value:function(){if(this._context.boundGeometry!=this){this._context.boundGeometry=this;for(var t in this._bufferAttributes)"index"!=t&&this._bufferAttributes[t].bind()}}},{key:"drawElements",value:function(t,e,n){this._bufferAttributes.index?(this._bufferAttributes.index.buffer.bind(),this._context.drawElements(t,e,this._context.UNSIGNED_SHORT,n),this._bufferAttributes.index.buffer.unbind()):console.error(this.constructor.name+" ERROR: you can not draw elements without an index attribute!")}},{key:"drawArrays",value:function(t,e,n){this._context.drawArrays(t,e,n)}},{key:"bufferAttributes",get:function(){return this._bufferAttributes}}]),e}(s.WebGlElement)},{"./BufferAttribute":3,"./WebGlElement":24}],7:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.GlyphAtlas=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement"),u=t("font-atlas");n.GlyphAtlas=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._atlas=new u(t),n._textureContext=n._atlas.context,n}return i(e,t),a(e,[{key:"canvas",get:function(){return this._atlas.canvas}},{key:"elements",get:function(){return this._atlas.elements}}]),e}(s.WebGlElement)},{"./WebGlElement":24,"font-atlas":28}],8:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Image=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./Mesh"),u=t("./Primitives"),l=t("./Geometry"),c=t("./BufferAttribute"),f=t("./MaterialHelper");n.Image=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._quad=(0,u.Quad)([0,0,0],[1,1,1]),n.geometry=new l.Geometry({context:n._context}),n.geometry.addBufferAttribute(new c.BufferAttribute({context:n._context,name:"position",data:new Float32Array(n._quad.vertices)})),n.geometry.addBufferAttribute(new c.BufferAttribute({context:n._context,name:"texCoord",data:new Float32Array(n._quad.uvs)})),n.geometry.addBufferAttribute(new c.BufferAttribute({context:n._context,name:"index",data:new Uint16Array(n._quad.indices)})),n.material=new f.MaterialHelper({context:n._context}).uColoredTexturedTriangles(),n.color=[1,1.01,1,1],n}return i(e,t),a(e,[{key:"imageUrl",set:function(t){this._material.imageUrl=t},get:function(){return this._material.imageUrl}},{key:"color",set:function(t){this._material.uniforms.solidColor={type:"vec4",data:t}},get:function(){return this._material.uniforms.solidColor.data}}]),e}(s.Mesh)},{"./BufferAttribute":3,"./Geometry":6,"./MaterialHelper":10,"./Mesh":11,"./Primitives":15}],9:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Material=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./utils"),u=t("./ShaderProgram"),l=t("./Shader"),c=t("./Texture"),f=t("./WebGlElement");n.Material=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._ready=!1,n.drawMode=t.drawMode,n.shaderProgram=t.shaderProgram,n.shaderUrl=t.shaderUrl,n.uniforms=t.uniforms||{},n.uniforms.time||(n.uniforms.time={type:"float",data:0}),n.image=t.image,n.imageUrl=t.imageUrl,n.texture=t.texture,n.multipleTextures=t.multipleTextures||[],n.rawTexture=t.texture,n.multipleRawTextures=t.multipleRawTextures||[],n.transparent=t.transparent||!1,n.depthTest=t.depthTest||!0,n.enableBlending=!0,n.sourceBlendingMode=t.sourceBlendingMode||n._context.SRC_ALPHA,n.destinationBlendingMode=t.destinationBlendingMode||n._context.ONE_MINUS_SRC_ALPHA,n._zIndex=t.zIndex||0,n._color={r:1,g:1,b:1,a:1},n.logWarn("Diploma Hack: need to change multiple textures handling for further develeopement!"),n}return i(e,t),a(e,[{key:"createShader",value:function(t){var e=new l.Shader({context:this._context,shaderType:this._context.VERTEX_SHADER});e.text="\n\t\t\tprecision mediump float;\n\n\t\t\t// Present in all shader\n\t\t\tuniform float time;\n\t\t\tuniform vec2 resolution;\n\n\t\t\tuniform mat4 mv_Matrix;\n\t\t\tuniform mat4 p_Matrix;\n\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 texCoord;\n\t\t\tattribute vec3 normal;\n\t\t\tattribute vec4 color;\n\n\t\t\tvec4 outPosition;\n\n\t\t"+t.vertexHeader+"\n\t\t\tvoid main () {\n\n\t\t\t\toutPosition = vec4 ( position.xyz, 1.0 );\n\n\t\t"+t.vertexBody+"\n\t\t\t\toutPosition = p_Matrix * mv_Matrix * vec4( outPosition.xyz, 1.0 );\n\n\t\t"+(t.vertexEnd||"")+"\n\n\t\t\t\tgl_Position = outPosition;\n\t\t\t}\n\n\t\t";var n=new l.Shader({context:this._context,shaderType:this._context.FRAGMENT_SHADER});n.text=(t.fragmentExtensions||"")+"\n\t\t\tprecision mediump float;\n\t\t\tuniform float time;\n\n\t\t"+t.fragmentHeader+"\n\t\t\tvoid main () {\n\n\t\t\t\tvec4 outColor;\n\n\t\t"+t.fragmentBody+"\n\t\t\t\tgl_FragColor = outColor;\n\n\t\t\t}\n\n\t\t";var r=new u.ShaderProgram({context:this._context,vertexShader:e.shader,fragmentShader:n.shader});this._shaderProgram=r}},{key:"bind",value:function(){if(this.multipleRawTextures.length>0)for(var t=this.multipleRawTextures.length-1;t>=0;t--)this._context.activeTexture(this._context.TEXTURE0+t),this._context.bindTexture(this._context.TEXTURE_2D,this.multipleRawTextures[t]);if(this.multipleTextures.length>0&&0==this.multipleRawTextures.length)for(var e=0;e<this.multipleTextures.length;e++)this._context.activeTexture(this._context["TEXTURE"+e]),this._context.bindTexture(this._context.TEXTURE_2D,this.multipleTextures[e]);this.rawTexture&&0==this.multipleTextures.length&&0==this.multipleRawTextures.length&&(this._context.activeTexture(this._context.TEXTURE0),this._context.bindTexture(this._context.TEXTURE_2D,this.rawTexture)),this.texture&&!this.rawTexture&&0==this.multipleTextures.length&&0==this.multipleRawTextures.length&&(this.texture.activeTexture(this._context.TEXTURE0),this.texture.bind()),this.shaderProgram&&this.shaderProgram.bind()}},{key:"unbind",value:function(){this.texture&&!this.rawTexture&&(this.texture.unbind(),this.texture.activeTexture(null)),this.rawTexture&&(this._context.activeTexture(null),this._context.bindTexture(this._context.TEXTURE_2D,null)),this.shaderProgram&&this.shaderProgram.unbind()}},{key:"clone",value:function(){new e({context:this._context})}},{key:"type",get:function(){return this._type}},{key:"drawMode",set:function(t){this._drawMode=t},get:function(){return this._drawMode}},{key:"depthTest",set:function(t){this._depthTest=t},get:function(){return this._depthTest}},{key:"zIndex",set:function(t){this._zIndex=t},get:function(){return this._zIndex}},{key:"shaderUrl",set:function(t){if(t){this._shaderUrl=t;var e=new u.ShaderProgram({context:this._context});(0,s.ajax)(t+".vert.glsl",function(t,n){if(t)console.error(t);else{var r=new l.Shader({context:this._context,shaderType:this._context.VERTEX_SHADER});r.text=n.responseText,e.vertexShader=r.shader,this._shaderProgram=e}}.bind(this)),(0,s.ajax)(t+".frag.glsl",function(t,n){if(t)console.error(t);else{var r=new l.Shader({context:this._context,shaderType:this._context.FRAGMENT_SHADER});r.text=n.responseText,e.fragmentShader=r.shader,this._shaderProgram=e}}.bind(this))}},get:function(){return this._shaderUrl}},{key:"imageUrl",set:function(t){if(t){this._imageUrl=t;var e=new Image;e.src=t,(0,s.addEvent)(e,"load",function(){this._image=e;var t=new c.Texture({context:this._context,image:e});this._texture=t}.bind(this))}},get:function(){return this._imageUrl}},{key:"image",set:function(t){this._image=t,this._texture||(this._texture=new c.Texture({context:this._context,image:t})),this._texture.image=t},get:function(){return this._image}},{key:"color",set:function(t){this._color=t},get:function(){return this._color}},{key:"shaderProgram",set:function(t){this._shaderProgram=t},get:function(){return this._shaderProgram}},{key:"uniforms",set:function(t){t&&(this._uniforms=t)},get:function(){return this._uniforms}},{key:"texture",set:function(t){this._texture=t},get:function(){return this._texture}},{key:"transparent",set:function(t){this._transparent=t},get:function(){return this._transparent}},{key:"ready",get:function(){return!!this._shaderProgram&&!(this._imageUrl&&!this._texture)}}]),e}(f.WebGlElement)},{"./Shader":19,"./ShaderProgram":20,"./Texture":22,"./WebGlElement":24,"./utils":42}],10:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.MaterialHelper=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement"),u=t("./Material");n.MaterialHelper=function(t){function e(t){return r(this,e),o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return i(e,t),a(e,[{key:"whiteLines",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.LINES});return t.createShader({vertexHeader:"\n\n\n\t\t\t",vertexBody:"\n\n\t\t\t",fragmentHeader:"\n\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = vec4 ( 1.0, 1.0, 1.0, 1.0 );\n\n\t\t\t"}),t}},{key:"blackLines",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.LINES});return t.createShader({vertexHeader:"\n\n\n\t\t\t",vertexBody:"\n\n\t\t\t",fragmentHeader:"\n\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = vec4 ( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t"}),t}},{key:"points",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.POINT});return t.createShader({vertexHeader:"\n\n\t\t\t",vertexBody:"\n\t\t\t\tgl_PointSize = 2.0;\n\n\t\t\t",fragmentHeader:"\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = vec4 ( 0.5, 0.5, 0.5, 1.0 );\n\n\t\t\t"}),t}},{key:"debugTriangles",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t",vertexBody:"\n\t\t\t",fragmentHeader:"\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = vec4 ( 1.0, 0.0, 1.0, 1.0 );\n\n\t\t\t"}),t}},{key:"vertexColoredLines",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.LINES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_Color = color;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = f_Color;\n\n\t\t\t"}),t}},{key:"vertexColorTriangles",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_Color = color;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = f_Color;\n\n\t\t\t"}),t}},{key:"pointSprites",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.POINT});return t.createShader({vertexHeader:"\n\n\t\t\t",vertexBody:"\n\t\t\t\tgl_PointSize = normal.x;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tuniform sampler2D sampler; \n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, gl_PointCoord);\n\t\t\t\toutColor = textureColor;\n\n\t\t\t"}),t}},{key:"coloredPointSprites",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.POINT});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_Color = color;\n\t\t\t\tgl_PointSize = normal.x;// / ( ( computedPosition.z * 0.3 ) + 0.0001 );\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tuniform sampler2D sampler; \n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, gl_PointCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor *= f_Color;\n\n\t\t\t"}),t}},{key:"vertexColorPointSprites",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.POINT});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",vertexBody:"\n\t\t\t\tgl_PointSize = normal.x;\n\t\t\t\tf_Color = color;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tuniform sampler2D sampler; \n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, gl_PointCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor *= f_Color;\n\n\t\t\t"}),t}},{key:"uColoredTriangles",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t",vertexBody:"\n\t\t\t",fragmentHeader:"\n\t\t\t\tuniform vec4 solidColor;\n\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = solidColor;\n\n\t\t\t"}),t}},{key:"coloredTriangles",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_Color = color;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = f_Color;\n\n\t\t\t"}),t}},{key:"texturedTriangles",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_TexCoord = texCoord;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tuniform sampler2D sampler; \n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\toutColor = textureColor;\n\n\t\t\t"}),t}},{key:"uColoredTexturedTriangles",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.uniforms.solidColor={type:"vec4",data:vec4.fromValues(1,1,1,1)},t.createShader({vertexHeader:"\n\t\t\t\t// varying vec4 f_Color;\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",vertexBody:"\n\t\t\t\t// f_Color = color;\n\t\t\t\tf_TexCoord = texCoord;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tuniform sampler2D sampler; \n\t\t\t\tuniform vec4 solidColor;\n\t\t\t\t// varying vec4 f_Color;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor *= solidColor;\n\t\t\t\t// outColor *= f_Color;\n\n\t\t\t\tif ( outColor.a <= 0.01 ) discard;\n\n\t\t\t"}),t}},{key:"coloredTexturedTriangles",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\tf_Color = color;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tuniform sampler2D sampler; \n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor *= f_Color;\n\n\t\t\t"}),t}},{key:"triangleTest",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\tf_Color = color;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = vec4 ( f_TexCoord.x, 0.0, 1.0, 1.0 );\n\n\t\t\t"}),t}},{key:"glyphs",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tuniform float alignMode;\n\t\t\t\tuniform float verticalAlignMode;\n\n\t\t\t\tuniform float letterSpacing;\n\t\t\t\tuniform float lineHeight;\n\t\t\t\tuniform float numLines;\n\n\t\t\t\tattribute vec4 textInfo;\n\n\t\t\t\t// textInfo.x : line length\n\t\t\t\t// textInfo.y : line index\n\t\t\t\t// textInfo.z : char index\n\t\t\t\t// textInfo.w : char num\n\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",vertexBody:"\n\t\t\t\t// Compute align offset\n\n\t\t\t\tfloat offset = 0.0;\n\n\t\t\t\tif ( alignMode == 0.0 ) {\n\n\t\t\t\t\toffset = 0.0;\n\n\t\t\t\t} else if ( alignMode == 1.0 ) {\n\n\t\t\t\t\toffset = -( textInfo.w - 1.0 ) * letterSpacing * 0.5 - textInfo.x * 0.5;\n\n\t\t\t\t} else if ( alignMode == 2.0 ) {\n\n\t\t\t\t\toffset = -( textInfo.w - 1.0 ) * letterSpacing * 0.5 - textInfo.x;\n\n\t\t\t\t}\n\n\t\t\t\t// Compute vertical align offset\n\n\t\t\t\tfloat verticalOffset = 0.0;\n\n\t\t\t\tif ( verticalAlignMode == 0.0 ) {\n\n\t\t\t\t\tverticalOffset = -0.5;\n\n\t\t\t\t} else if ( verticalAlignMode == 1.0 ) {\n\n\t\t\t\t\tverticalOffset = ( numLines - 1.0 ) * lineHeight * 0.5;\t\t\t\t\t\n\n\t\t\t\t} else if ( verticalAlignMode == 2.0 ) {\n\n\t\t\t\t\tverticalOffset = ( numLines - 1.0 ) * lineHeight + lineHeight * 0.5;\t\n\n\t\t\t\t}\n\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\t\n\t\t\t\toutPosition.x += letterSpacing * textInfo.z + offset;\n\t\t\t\toutPosition.y -= textInfo.y * lineHeight - verticalOffset;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tuniform sampler2D sampler; \n\t\t\t\tuniform vec4 solidColor;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor.r = solidColor.r;\n\t\t\t\toutColor.g = solidColor.g;\n\t\t\t\toutColor.b = solidColor.b;\n\t\t\t\toutColor.a = textureColor.a * textureColor.g * textureColor.b * solidColor.a;\n\n\t\t\t\t// if ( outColor.a < 0.001 ) discard;\n\n\t\t\t"}),t}},{key:"sdfGlyphs",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tuniform float alignMode;\n\t\t\t\tuniform float verticalAlignMode;\n\n\t\t\t\tuniform float letterSpacing;\n\t\t\t\tuniform float lineHeight;\n\t\t\t\tuniform float numLines;\n\n\t\t\t\tattribute vec4 textInfo;\n\n\t\t\t\t// textInfo.x : line length\n\t\t\t\t// textInfo.y : line index\n\t\t\t\t// textInfo.z : char index\n\t\t\t\t// textInfo.w : char num\n\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",vertexBody:"\n\t\t\t\t// Compute align offset\n\n\t\t\t\tfloat offset = 0.0;\n\n\t\t\t\tif ( alignMode == 0.0 ) {\n\n\t\t\t\t\toffset = 0.0;\n\n\t\t\t\t} else if ( alignMode == 1.0 ) {\n\n\t\t\t\t\toffset = -( textInfo.w - 1.0 ) * letterSpacing * 0.5 - textInfo.x * 0.5;\n\n\t\t\t\t} else if ( alignMode == 2.0 ) {\n\n\t\t\t\t\toffset = -( textInfo.w - 1.0 ) * letterSpacing * 0.5 - textInfo.x;\n\n\t\t\t\t}\n\n\t\t\t\t// Compute vertical align offset\n\n\t\t\t\tfloat verticalOffset = 0.0;\n\n\t\t\t\tif ( verticalAlignMode == 0.0 ) {\n\n\t\t\t\t\tverticalOffset = -0.5;\n\n\t\t\t\t} else if ( verticalAlignMode == 1.0 ) {\n\n\t\t\t\t\tverticalOffset = ( numLines - 1.0 ) * lineHeight * 0.5;\t\t\t\t\t\n\n\t\t\t\t} else if ( verticalAlignMode == 2.0 ) {\n\n\t\t\t\t\tverticalOffset = ( numLines - 1.0 ) * lineHeight + lineHeight * 0.5;\t\n\n\t\t\t\t}\n\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\t\n\t\t\t\toutPosition.x += letterSpacing * textInfo.z + offset;\n\t\t\t\toutPosition.y -= textInfo.y * lineHeight - verticalOffset;\n\t\t\t\t\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tuniform sampler2D sampler; \n\t\t\t\tuniform vec4 solidColor;\n\t\t\t\tfloat target = 0.70;\n\t\t\t\tfloat smoothing = 1.0/5.0;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor.r = 0.0;\n\t\t\t\toutColor.g = 0.0;\n\t\t\t\toutColor.b = 0.0;\n\t\t\t\t// outColor.a = textureColor.r * textureColor.g * textureColor.b;\n\t\t\t\tfloat alpha = smoothstep( target - smoothing, target + smoothing, textureColor.r);\n\t\t\t\toutColor.a = alpha;\n\t\t\t\t// if ( outColor.a < 0.1 ) discard;\n\n\t\t\t"}),t}},{key:"screen",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tuniform vec2 screenResolution;\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_TexCoord = vec2 ( position.x / screenResolution.x, position.y / screenResolution.y );\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tuniform sampler2D sampler; \n\t\t\t\tuniform vec2 screenResolution;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, vec2 ( gl_FragCoord.x / screenResolution.x, gl_FragCoord.y / screenResolution.y ));\n\t\t\t\toutColor = textureColor;\n\n\t\t\t\toutColor.a -= 0.25;\n\t\t\t\toutColor.a /= 0.75;\n\n\t\t\t\t// if ( outColor.a < 0.3 ) discard;\n\n\t\t\t"}),t}},{key:"screenButton",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tuniform vec2 screenResolution;\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tvarying vec2 f_Uv;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_Uv = texCoord;\n\t\t\t\tf_TexCoord = vec2 ( position.x / screenResolution.x, position.y / screenResolution.y );\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_Uv;\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tuniform sampler2D sampler; \n\t\t\t\tuniform vec2 screenResolution;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, vec2 ( gl_FragCoord.x / screenResolution.x, gl_FragCoord.y / screenResolution.y ));\n\t\t\t\toutColor = textureColor;\n\n\t\t\t\toutColor.a -= 0.25;\n\t\t\t\toutColor.a /= 0.75;\n\n\t\t\t\tfloat cDist = length ( f_Uv - 0.5 ) * 2.0;\n\t\t\t\toutColor.a = smoothstep ( 1.0, 0.95, cDist );\n\n\t\t\t\t// if ( outColor.a < 0.001 ) discard;\n\n\t\t\t"}),t}},{key:"sdfTexture",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.uniforms={solidColor:{type:"vec4",data:vec4.fromValues(0,0,0,1)},sdfSmoothing:{type:"float",data:.003144},sdfTarget:{type:"float",data:.2}},t.createShader({vertexHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\t\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tuniform sampler2D sampler; \n\t\t\t\tuniform vec4 solidColor;\n\t\t\t\tuniform float sdfTarget;\n\t\t\t\tuniform float sdfSmoothing;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\tfloat fragGreyValue = textureColor.r * textureColor.g * textureColor.b;\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor.r = solidColor.r;\n\t\t\t\toutColor.g = solidColor.g;\n\t\t\t\toutColor.b = solidColor.b;\n\t\t\t\t\n\t\t\t\tfloat alpha = smoothstep( sdfTarget - sdfSmoothing, sdfTarget + sdfSmoothing, fragGreyValue);\n\t\t\t\toutColor.a = ( 1.0 - alpha ) * solidColor.a;\n\t\t\t\tif ( outColor.a < 0.01 ) discard;\n\n\t\t\t"}),t}},{key:"field",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.LINES});return t.depthTest=!0,t.uniforms.solidColor={type:"vec4",data:vec4.fromValues(0,0,0,1)},t.uniforms.sdfSmoothing={type:"float",data:.05},t.uniforms.sdfTarget={type:"float",data:.1},t.createShader({vertexHeader:"\n\t\t\t\tconst int MAX_ATTRACTORS = 100;\n\t\t\t\tuniform vec3 mouse;\n\t\t\t\tuniform float numAttractors;\n\t\t\t\tuniform vec3 attractors[ MAX_ATTRACTORS ];\n\t\t\t\tuniform float initTimes[ MAX_ATTRACTORS ];\n\n\t\t\t\tfloat animationDuration = 4.0;\n\t\t\t\tfloat maxRadius = 2.0;\n\n\t\t\t",vertexBody:"\n\n\t\t\t\tvec3 vertexPosition = outPosition.xyz;\n\t\t\t\tfloat maxDistance = 1.5;\n\n\t\t\t\tfor ( int i = 0; i < MAX_ATTRACTORS; i ++ ) {\n\n\t\t\t\t\tif ( i < int ( numAttractors ) ) {\n\n\t\t\t\t\t\tvec3 force = attractors[ i ] - vertexPosition;\n\n\t\t\t\t\t\tfloat distance = length ( force );\n\n\t\t\t\t\t\tif ( distance > maxDistance ) {\n\n\t\t\t\t\t\t\tdistance = maxDistance;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tfloat animationMultiplier = ( time - initTimes[ i ] ) / animationDuration;\n\n\t\t\t\t\t\tif ( animationMultiplier > 1.0 ) {\n\n\t\t\t\t\t\t\tanimationMultiplier = 1.0;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\toutPosition.xyz += force * ( 1.0 - ( distance / maxDistance ) * ( distance / maxDistance ) ) * animationMultiplier;\n\n\t\t\t\t\t}\t\n\n\t\t\t\t}\n\n\t\t\t\tfor ( int i = 0; i < MAX_ATTRACTORS; i ++ ) {\n\n\t\t\t\t\tif ( i < int ( numAttractors ) ) {\n\n\t\t\t\t\t\tvec3 inverseForce = vertexPosition - outPosition.xyz;\n\t\t\t\t\t\t// outPosition.xyz += inverseForce * length ( inverseForce );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tuniform vec4 solidColor;\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor.r = solidColor.r;\n\t\t\t\toutColor.g = solidColor.g;\n\t\t\t\toutColor.b = solidColor.b;\n\t\t\t\toutColor.a = 1.0;\n\t\t\t\t// if ( outColor.a < 0.01 ) discard;\n\n\t\t\t"}),t}},{key:"gridSimulation",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec2 f_Uv;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_Uv = texCoord.xy;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\t#extension GL_OES_standard_derivatives : enable\n\t\t\t\t// uniform vec3 mouse;\n\t\t\t\tuniform float numAttractors;\n\t\t\t\tconst int MAX_ATTRACTORS = 100;\n\t\t\t\tuniform vec3 attractors[ MAX_ATTRACTORS ];\n\n\t\t\t\tvarying vec2 f_Uv;\n\t\t\t\t// uniform vec4 masses;\n\t\t\t\tuniform sampler2D positions;\n\t\t\t\tuniform sampler2D ssk;\n\t\t\t\tuniform sampler2D baseGrid;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec3 pos = texture2D ( positions, f_Uv ).rgb;\n\t\t\t\tvec3 ginPos = texture2D ( ssk, f_Uv ).rgb;\t\n\t\t\t\tvec3 originPos = texture2D ( baseGrid, f_Uv ).rgb;\t\n\n\t\t\t\tvec3 oForce = originPos - pos;\n\t\t\t\tfloat oDist = length ( oForce ) * 30.0;\t\n\n\t\t\t\tfor ( int i = 0; i < MAX_ATTRACTORS; i ++ ) {\n\n\t\t\t\t\tif ( i >= int ( numAttractors ) ) break;\n\n\t\t\t\t\tvec3 center = attractors[ i ];\n\n\t\t\t\t\tvec3 dir = center - pos;\n\t\t\t\t\tfloat maxDist = 1.0;\n\t\t\t\t\tfloat dist = length ( dir );\n\t\t\t\t\tfloat dM = dist / maxDist;\n\n\t\t\t\t\tpos += (dir / ( dist * dist ) * dM * 0.01) * (1.0 - oDist);\n\t\t\t\t\t\n\n\t\t\t\t}\t\t\n\t\t\t\t\n\t\t\t\toutColor = vec4 ( pos, 1.0 );\n\n\t\t\t"}),t}},{key:"gridDestination",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.LINES});return t.createShader({vertexHeader:"\n\t\t\t\tuniform sampler2D positions;\n\t\t\t\tvarying float f_Dist;\n\n\t\t\t",vertexBody:"\n\t\t\t\toutPosition = vec4 ( texture2D ( positions, position.xy ).xyz, 1.0 );\n\t\t\t\tf_Dist = length ( vec3 ( 0.0, 0.0, 0.0 ) - outPosition.xyz ) + 0.5; \n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying float f_Dist;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tfloat greyValue = ( 1.0 / f_Dist ) * 0.7;\n\t\t\t\toutColor = vec4 ( greyValue, greyValue, greyValue, 1.0);\n\n\t\t\t"}),t}},{key:"basicGravityElement",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tattribute vec3 transforms;\n\t\t\t\tattribute vec3 scale;\n\t\t\t\tattribute vec3 rotation;\n\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t\tmat4 scaleMatrix ( vec3 scale ) {\n\n\t\t\t\t\treturn mat4(scale.x, 0.0, 0.0, 0.0,\n\t\t\t\t                0.0, scale.y, 0.0, 0.0,\n\t\t\t\t                0.0, 0.0, scale.z, 0.0,\n\t\t\t\t                0.0, 0.0, 0.0, 1.0);\n\n\t\t\t\t}\n\n\t\t\t\tmat4 rotationMatrix(vec3 axis, float angle) {\n\n\t\t\t\t    axis = normalize(axis);\n\t\t\t\t    float s = sin(angle);\n\t\t\t\t    float c = cos(angle);\n\t\t\t\t    float oc = 1.0 - c;\n\t\t\t\t    \n\t\t\t\t    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n\t\t\t\t                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n\t\t\t\t                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n\t\t\t\t                0.0,                                0.0,                                0.0,                                1.0);\n\t\t\t\t}\n\n\t\t\t",vertexBody:"\n\n\t\t\t\toutPosition *= scaleMatrix ( scale );\n\t\t\t\t\n\t\t\t\toutPosition *= rotationMatrix ( vec3(0, 0, 1), rotation.z );\n\t\t\t\toutPosition *= rotationMatrix ( vec3(0, 1, 0), rotation.y );\n\t\t\t\toutPosition *= rotationMatrix ( vec3(1, 0, 0), rotation.x );\n\n\t\t\t\toutPosition.x += transforms.x;\n\t\t\t\toutPosition.y += transforms.y;\n\t\t\t\toutPosition.z += transforms.z;\n\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\tf_Color = color;\n\n\t\t\t",vertexEnd:"\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tuniform sampler2D sampler; \n\t\t\t\tuniform float colorMode;\n\n\t\t\t",fragmentBody:"\n\n\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\toutColor = textureColor;\n\n\t\t\t\tif ( colorMode == 0.0 ) {\n\n\t\t\t\t\toutColor *= f_Color;\n\n\t\t\t\t} else if ( colorMode == 1.0 ) {\n\n\t\t\t\t\toutColor *= 1.0;\n\n\t\t\t\t} else if ( colorMode == 2.0 ) {\n\n\t\t\t\t\toutColor.rbg *= 0.0;\n\t\t\t\t\t// outColor.a = 1.0;\n\n\t\t\t\t}\n\n\t\t\t\t\n\n\t\t\t"}),t}},{key:"basicGravityElementInfo",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tattribute vec3 transforms;\n\t\t\t\tattribute vec3 scale;\n\t\t\t\tattribute vec3 rotation;\n\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tvarying vec3 f_Scale;\n\n\t\t\t\tmat4 scaleMatrix ( vec3 scale ) {\n\n\t\t\t\t\treturn mat4(scale.x, 0.0, 0.0, 0.0,\n\t\t\t\t                0.0, scale.y, 0.0, 0.0,\n\t\t\t\t                0.0, 0.0, scale.z, 0.0,\n\t\t\t\t                0.0, 0.0, 0.0, 1.0);\n\n\t\t\t\t}\n\n\t\t\t\tmat4 rotationMatrix(vec3 axis, float angle) {\n\n\t\t\t\t    axis = normalize(axis);\n\t\t\t\t    float s = sin(angle);\n\t\t\t\t    float c = cos(angle);\n\t\t\t\t    float oc = 1.0 - c;\n\t\t\t\t    \n\t\t\t\t    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n\t\t\t\t                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n\t\t\t\t                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n\t\t\t\t                0.0,                                0.0,                                0.0,                                1.0);\n\t\t\t\t}\n\n\t\t\t",vertexBody:"\n\n\t\t\t\toutPosition *= scaleMatrix ( scale );\n\t\t\t\t\n\t\t\t\toutPosition *= rotationMatrix ( vec3(0, 0, 1), rotation.z );\n\t\t\t\toutPosition *= rotationMatrix ( vec3(0, 1, 0), rotation.y );\n\t\t\t\toutPosition *= rotationMatrix ( vec3(1, 0, 0), rotation.x );\n\n\t\t\t\toutPosition.x += transforms.x;\n\t\t\t\toutPosition.y += transforms.y;\n\t\t\t\toutPosition.z += transforms.z;\n\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\tf_Color = color;\n\t\t\t\tf_Scale = scale;\n\n\t\t\t",vertexEnd:"\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tvarying vec3 f_Scale;\n\t\t\t\tuniform sampler2D sampler; \n\t\t\t\tuniform float colorMode;\n\n\t\t\t",fragmentBody:"\n\n\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor.rbg *= 0.0;\n\n\t\t\t\t// VerticalLine\n\n\t\t\t\tfloat lineWidth = 0.005;\n\t\t\t\tfloat hDist = abs ( f_TexCoord.x * f_Scale.x - f_Scale.x * 0.5 ) ;\n\t\t\t\tfloat vDist = abs ( f_TexCoord.y * f_Scale.y - f_Scale.y * 0.5 ) ;\n\n\t\t\t\tif ( hDist < lineWidth && vDist < 0.05 ) {\n\n\t\t\t\t\toutColor.a = 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tif ( hDist < 0.05 && vDist < lineWidth ) {\n\n\t\t\t\t\toutColor.a = 1.0;\n\n\t\t\t\t}\n\n\t\t\t"}),t}},{key:"smoke",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.POINT});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\n\t\t\t",vertexBody:"\n\t\t\t\tgl_PointSize = outPosition.z;\n\t\t\t\tf_Color = color;\n\n\t\t\t\toutPosition.z = 0.0;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tuniform sampler2D sampler; \n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, gl_PointCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor *= f_Color;\n\n\t\t\t"}),t}},{key:"dust",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.POINT});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tvarying float f_Radius;\n\n\t\t\t",vertexBody:"\n\t\t\t\tgl_PointSize = outPosition.z;\n\t\t\t\tf_Radius = outPosition.z;\n\t\t\t\tf_Color = color;\n\n\t\t\t\toutPosition.z = 0.0;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tvarying float f_Radius;\n\t\t\t\t// uniform sampler2D sampler; \n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec2 center = vec2( 0.5, 0.5 );\n\t\t\t\tfloat dist = length( gl_PointCoord.xy - center );\n\n\t\t\t\toutColor = vec4 ( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\toutColor.a = f_Color.a * 0.2;\n\t\t\t\toutColor.a *= smoothstep( 0.5, 0.0, dist);\n\n\t\t\t"}),t}},{key:"border",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tvarying vec3 f_Normal;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\tf_Normal = normal;\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec3 f_Normal;\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tfloat hDist = ( abs ( 0.5 - f_TexCoord.x ) / 0.5 ) * f_Normal.x;\n\t\t\t\tfloat vDist = ( abs ( 0.5 - f_TexCoord.y ) / 0.5 ) * f_Normal.y;\n\n\t\t\t\toutColor = vec4 ( 0.9, 0.9, 0.9, 0.0 );\n\n\t\t\t\toutColor.a += smoothstep ( f_Normal.x - 0.15, f_Normal.x - 0.14, hDist );\n\t\t\t\toutColor.a += smoothstep ( f_Normal.y - 0.15, f_Normal.y - 0.14, vDist );\n\n\t\t\t"}),t}},{key:"goal",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\n\t\t\t",vertexBody:"\n\n\t\t\t",fragmentHeader:"\n\t\t\t\tuniform vec4 solidColor;\n\n\t\t\t",fragmentBody:"\n\t\t\t\toutColor = solidColor;\n\n\t\t\t"}),t}},{key:"basicElecromagneticElement",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tattribute vec3 transforms;\n\t\t\t\tattribute vec3 scale;\n\t\t\t\tattribute vec3 rotation;\n\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tvarying vec2 f_TexCoord;\n\n\t\t\t\tmat4 scaleMatrix ( vec3 scale ) {\n\n\t\t\t\t\treturn mat4(scale.x, 0.0, 0.0, 0.0,\n\t\t\t\t                0.0, scale.y, 0.0, 0.0,\n\t\t\t\t                0.0, 0.0, scale.z, 0.0,\n\t\t\t\t                0.0, 0.0, 0.0, 1.0);\n\n\t\t\t\t}\n\n\t\t\t\tmat4 rotationMatrix(vec3 axis, float angle) {\n\n\t\t\t\t    axis = normalize(axis);\n\t\t\t\t    float s = sin(angle);\n\t\t\t\t    float c = cos(angle);\n\t\t\t\t    float oc = 1.0 - c;\n\t\t\t\t    \n\t\t\t\t    return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\n\t\t\t\t                oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\n\t\t\t\t                oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\n\t\t\t\t                0.0,                                0.0,                                0.0,                                1.0);\n\t\t\t\t}\n\n\t\t\t",vertexBody:"\n\n\t\t\t\toutPosition *= scaleMatrix ( scale );\n\t\t\t\t\n\t\t\t\toutPosition *= rotationMatrix ( vec3(0, 0, 1), rotation.z );\n\t\t\t\toutPosition *= rotationMatrix ( vec3(0, 1, 0), rotation.y );\n\t\t\t\toutPosition *= rotationMatrix ( vec3(1, 0, 0), rotation.x );\n\n\t\t\t\toutPosition.x += transforms.x;\n\t\t\t\toutPosition.y += transforms.y;\n\t\t\t\toutPosition.z += transforms.z;\n\n\t\t\t\tf_TexCoord = texCoord;\n\t\t\t\tf_Color = color;\n\n\t\t\t",vertexEnd:"\n\t\t\t",fragmentHeader:"\n\t\t\t\tvarying vec2 f_TexCoord;\n\t\t\t\tvarying vec4 f_Color;\n\t\t\t\tuniform sampler2D sampler; \n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec4 textureColor = texture2D( sampler, f_TexCoord);\n\t\t\t\toutColor = textureColor;\n\t\t\t\toutColor *= f_Color;\n\n\t\t\t"}),t}},{key:"equidistantLines",value:function(){var t=new u.Material({context:this._context,drawMode:this._context.TRIANGLES});return t.createShader({vertexHeader:"\n\t\t\t\tvarying vec2 f_Uv;\n\t\t\t\tvarying vec3 f_Pos;\n\n\t\t\t",vertexBody:"\n\t\t\t\tf_Uv = texCoord;\n\n\t\t\t",vertexEnd:"\n\t\t\t\tf_Pos = outPosition.xyz;\n\n\t\t\t",fragmentExtensions:"\n\t\t\t\t// #extension GL_EXT_shader_texture_lod : enable\n\t\t\t\t#extension GL_OES_standard_derivatives : enable\n\n\t\t\t",fragmentHeader:"\n\n\t\t\t\tconst int MAX_CHARGES = 100;\n\t\t\t\tuniform vec2 screen;\n\t\t\t\tuniform float numCharges;\n\t\t\t\tuniform vec4 charges [ MAX_CHARGES ];\n\n\t\t\t\tvarying vec2 f_Uv;\n\t\t\t\tvarying vec3 f_Pos;\n\n\t\t\t",fragmentBody:"\n\t\t\t\tvec2 pos = vec2 ( f_Uv * screen );\n\t\t\t\tpos.x = screen.x - pos.x;\n\n\t\t\t\toutColor = vec4 ( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tfor ( int i = 0; i < MAX_CHARGES; i ++ ) {\n\n\t\t\t\t\tif ( i >= int ( numCharges ) ) break;\n\n\t\t\t\t\tvec2 cPose = charges[ i ].xy;\n\t\t\t\t\tfloat cCharge = charges[ i ].w;\n\t\t\t\t\tfloat dist = length ( cPose - pos ) * 0.1 + 1.0;\n\n\t\t\t\t\tfloat eF = 1.0 / dist;\n\n\t\t\t\t\tfor ( int j = 0; j < 5; j ++ ) {\n\n\t\t\t\t\t\tfloat step = 1.0 / 5.0;\n\t\t\t\t\t\tfloat tF = step * float ( j );\n\t\t\t\t\t\tfloat dF = abs ( tF - eF );\n\n\t\t\t\t\t\t// if ( dF < 0.1 ) outColor += vec4 ( eF, eF, eF, 1.0 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\toutColor += vec4 ( eF, eF, eF, 1.0 );\n\n\t\t\t\t}\n\n\t\t\t\tvec3 P = outColor.rgb;\n\t\t\t\tfloat gsize = 50.5;\n\t\t\t\tfloat gwidth = 1.5;\n\n\t\t\t\tvec3 f  = abs(fract (P * gsize)-0.5);\n\t\t\t\tvec3 df = fwidth(P * gsize);\n\t\t\t\tvec3 g = smoothstep(-gwidth*df,gwidth*df , f);\n\t\t\t\tfloat c = g.x * g.y * g.z; \n\t\t\t\toutColor = vec4(1.0 - c, 1.0 - c, 1.0 - c, 1.0);// * gl_Color;\n\n\t\t\t\t// vec3 f  = fract (outColor.rgb * 100.0);\n\t\t\t //    vec3 df = fwidth(outColor.rgb * 100.0);\n\n\t\t\t //    vec3 g = smoothstep(df * 2.0, df * 2.5, f);\n\n\t\t\t //    float c = g.x * g.y * g.z;\n\n\t\t\t //    outColor = vec4(1.0 - c, 1.0 - c, 1.0 - c, 1.0);\n\n\t\t\t\t// float t = 0.3;\n\t\t\t\t// float w = 0.001;\n\t\t\t\t// float d = abs ( outColor.r - t ); \n\n\t\t\t\t// float std = fwidth( outColor );\n\n\t\t\t\t// if ( std < 0.001 ) {\n\n\t\t\t\t// \toutColor.r = 0.0;\n\n\t\t\t\t// }\n\n\t\t\t"}),t}}]),e}(s.WebGlElement)},{"./Material":9,"./WebGlElement":24}],11:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Mesh=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=function t(e,n,r){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},u=t("./Transform"),l=t("./Material"),c=t("./Geometry"),f=t("./BufferAttribute");n.Mesh=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.geometry=t.geometry,n.material=t.material,n._colliderType="Triangles",n}return i(e,t),a(e,[{key:"clone",value:function(){var t=new l.Material({context:this._context});t.shaderProgram=this._material.shaderProgram,t.imageUrl=this._material.imageUrl,t.uniforms=this._material.uniforms,t.transparent=this._material.transparent,t.drawMode=this._material.drawMode,t.depthTest=this._material.depthTest,t.zIndex=this._material.zIndex;var n=new c.Geometry({context:this._context});this._geometry.bufferAttributes.position&&n.addBufferAttribute(new f.BufferAttribute({context:this._context,name:"position",data:new Float32Array(this._geometry.bufferAttributes.position.data)})),this._geometry.bufferAttributes.color&&n.addBufferAttribute(new f.BufferAttribute({context:this._context,name:"color",data:new Float32Array(this._geometry.bufferAttributes.color.data)})),this._geometry.bufferAttributes.texCoord&&n.addBufferAttribute(new f.BufferAttribute({context:this._context,name:"texCoord",data:new Float32Array(this._geometry.bufferAttributes.texCoord.data)})),this._geometry.bufferAttributes.normal&&n.addBufferAttribute(new f.BufferAttribute({context:this._context,name:"normal",data:new Float32Array(this._geometry.bufferAttributes.normal.data)})),this._geometry.bufferAttributes.index&&n.addBufferAttribute(new f.BufferAttribute({context:this._context,name:"index",data:new Uint16Array(this._geometry.bufferAttributes.index.data)}));var r=new e({context:this._context,name:this._name,geometry:n,material:t});return r.position=vec3.clone(s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"position",this)),r.rotation=vec3.clone(s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rotation",this)),r.scale=vec3.clone(s(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"scale",this)),r}},{key:"draw",value:function(){this._geometry.bind(),this._geometry.bufferAttributes.index?this._geometry.drawElements(this._material.drawMode,this._geometry.bufferAttributes.index.data.length,0):this._geometry.drawArrays(this._material.drawMode,0,this._geometry.bufferAttributes.position.data.length/3)}},{key:"drawElements",value:function(t,e,n){this._geometry.bind(),this._geometry.drawElements(t,e,n)}},{key:"drawArrays",value:function(t,e,n){this._geometry.bind(),this._geometry.drawArrays(t,e,n)}},{key:"geometry",set:function(t){this._geometry=t},get:function(){return this._geometry}},{key:"colliderType",set:function(t){this._colliderType=t},get:function(){return this._colliderType}},{key:"material",set:function(t){t&&("Material"==t.type?this._material=t:console.error(this.type+" ERROR: not a material! "))},get:function(){return this._material}},{key:"modelMatrix",get:function(){var t=mat4.create();return mat4.translate(t,t,this.position),mat4.rotateX(t,t,this.rotation[0]),mat4.rotateY(t,t,this.rotation[1]),mat4.rotateZ(t,t,this.rotation[2]),mat4.scale(t,t,this.scale),t}},{key:"inverseModelMatrix",get:function(){var t=mat4.create();return mat4.translate(t,t,this.position),mat4.rotateX(t,t,this.rotation[0]),mat4.rotateY(t,t,this.rotation[1]),mat4.rotateZ(t,t,this.rotation[2]),mat4.scale(t,t,this.scale),mat4.invert(t,t),t}}]),e}(u.Transform)},{"./BufferAttribute":3,"./Geometry":6,"./Material":9,"./Transform":23}],12:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.OrthoCamera=void 0;var a=t("./Camera");n.OrthoCamera=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._type="Camera",n.width=t.width||t.context.renderer.realWidth,n.height=t.height||t.context.renderer.realHeight,n.nearClipPlane=t.nearClipPlane||-400,n.farClipPlane=t.farClipPlane||400,mat4.lookAt(n._vMatrix,[0,0,-10],[0,0,0],[0,1,0]),mat4.ortho(n._pMatrix,0,-n.width,n.height,0,n.nearClipPlane,n.farClipPlane),n}return i(e,t),e}(a.Camera)},{"./Camera":4}],13:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.P3D=void 0;var r=t("./utils"),o=t("./WebGlRenderer"),i=t("./OrthoCamera"),a=t("./PerspectiveCamera"),s=t("./Transform"),u=t("./Buffer"),l=t("./BufferAttribute"),c=t("./Geometry"),f=t("./Mesh"),h=t("./Axis"),d=t("./Texture"),m=t("./Primitives"),_=t("./Material"),x=t("./Scene"),p=t("./Fbo"),v=t("./Shader"),y=t("./ShaderProgram"),g=t("./Raycast"),b=t("./MaterialHelper"),w=t("./Text"),T=t("./GlyphAtlas"),C=t("./SdfGlyphAtlas"),A=t("./Image"),E=(t("fs"),t("geom-parse-obj")),P={WebGlRenderer:o.WebGlRenderer,OrthoCamera:i.OrthoCamera,PerspectiveCamera:a.PerspectiveCamera,Transform:s.Transform,BufferAttribute:l.BufferAttribute,Buffer:u.Buffer,Geometry:c.Geometry,Mesh:f.Mesh,Axis:h.Axis,Texture:d.Texture,Image:A.Image,Quad:m.Quad,Cube:m.Cube,Circle:m.Circle,Material:_.Material,Scene:x.Scene,Fbo:p.Fbo,Shader:v.Shader,ShaderProgram:y.ShaderProgram,Raycast:g.Raycast,LoadObj:function(t,e){(0,r.ajax)(t,function(t,n){var r=E(n.responseText);e({positions:[].concat.apply([],r.positions),indices:[].concat.apply([],r.cells),uvs:[].concat.apply([],r.uvs),normals:[].concat.apply([],r.normals)})})},CreateMeshFromObj:function(t,e){if(t){var n=new c.Geometry({context:t});return e.positions.length>0&&n.addBufferAttribute(new l.BufferAttribute({context:t,name:"position",data:new Float32Array(e.positions)})),e.uvs.length>0&&n.addBufferAttribute(new l.BufferAttribute({context:t,name:"texCoord",data:new Float32Array(e.uvs)})),e.normals.length>0&&n.addBufferAttribute(new l.BufferAttribute({context:t,name:"normal",data:new Float32Array(e.normals)})),e.indices.length>0&&n.addBufferAttribute(new l.BufferAttribute({context:t,name:"index",data:new Uint16Array(e.indices)})),new f.Mesh({context:t,geometry:n,material:null})}console.error("CreateMeshFromObj ERROR: context not defined!")},ObjParser:E,MaterialHelper:b.MaterialHelper,Text:w.Text,GlyphAtlas:T.GlyphAtlas,SdfGlyphAtlas:C.SdfGlyphAtlas};n.P3D=P},{"./Axis":1,"./Buffer":2,"./BufferAttribute":3,"./Fbo":5,"./Geometry":6,"./GlyphAtlas":7,"./Image":8,"./Material":9,"./MaterialHelper":10,"./Mesh":11,"./OrthoCamera":12,"./PerspectiveCamera":14,"./Primitives":15,"./Raycast":16,"./Scene":17,"./SdfGlyphAtlas":18,"./Shader":19,"./ShaderProgram":20,"./Text":21,"./Texture":22,"./Transform":23,"./WebGlRenderer":25,"./utils":42,fs:26,"geom-parse-obj":29}],14:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.PerspectiveCamera=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./Camera");n.PerspectiveCamera=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._type="Camera",n.fov=t.fov||45,n.displayRatio=t.displayRatio||t.context.renderer.realWidth/t.context.renderer.realHeight,n.nearClipPlane=t.nearClipPlane||.1,n.farClipPlane=t.farClipPlane||1e3,mat4.perspective(n._pMatrix,glMatrix.toRadian(n._fov),n._displayRatio,n._nearClipPlane,n._farClipPlane),mat4.lookAt(n._vMatrix,[0,0,0],[0,0,0],[0,1,0]),n}return i(e,t),a(e,[{key:"fov",set:function(t){this._fov=t},get:function(){return this._fov}},{key:"displayRatio",set:function(t){this._displayRatio=t},get:function(){return this._displayRatio}}]),e}(s.Camera)},{"./Camera":4}],15:[function(t,e,n){"use strict";function r(t,e){t[0],t[1],t[2];var n=[-.5,.5,0,.5,.5,0,.5,-.5,0,-.5,-.5,0],r=new Float32Array(16);mat4.identity(r);var o=new Float32Array(16);mat4.identity(o);var i=new Float32Array(16);mat4.identity(i),mat4.scale(o,r,e),mat4.translate(i,r,t);for(var a=0;a<n.length;a+=3){var s=[n[a+0],n[a+1],n[a+2]];vec3.transformMat4(s,s,o),vec3.transformMat4(s,s,i),n[a+0]=s[0],n[a+1]=s[1],n[a+2]=s[2]}return{vertices:n,positions:n,uvs:[0,0,1,0,1,1,0,1],indices:[0,1,2,0,2,3],wIndices:[0,2,0,1,1,2,2,3,3,0],cIndices:[0,1,1,2,2,3,3,0],normals:[]}}function o(t,e){var n=[-.5,.5,.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5],r=new Float32Array(16);mat4.identity(r);var o=new Float32Array(16);mat4.identity(o);var i=new Float32Array(16);mat4.identity(i),mat4.scale(o,r,e),mat4.translate(i,r,t);for(var a=0;a<n.length;a+=3){var s=[n[a+0],n[a+1],n[a+2]];vec3.transformMat4(s,s,o),vec3.transformMat4(s,s,i),n[a+0]=s[0],n[a+1]=s[1],n[a+2]=s[2]}return{vertices:n,uvs:[0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,1],indices:[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],wIndices:[0,2,0,1,1,2,2,3,3,0,4,6,4,5,5,6,6,7,7,4,8,10,8,9,9,10,10,11,11,8,12,14,12,13,13,14,14,15,15,12,16,18,16,17,17,18,18,19,19,16,20,22,20,21,21,22,22,23,23,20],cIndices:[0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,8,9,9,10,10,11,11,8,12,13,13,14,14,15,15,12,16,17,17,18,18,19,19,16,20,21,21,22,22,23,23,20]}}function i(t,e,n){var r=[],o=[],i=[],a=[],s=[],u=2*Math.PI/n;r.push(t[0]),r.push(t[1]),r.push(t[2]),s.push(.5),s.push(.5);for(var l=0;l<n;l++){var c=t[0]+Math.cos(u*l)*e,f=t[1]+Math.sin(u*l)*e,h=t[2];r.push(c),r.push(f),r.push(h),s.push(.5*(Math.cos(u*l)+1)),s.push(1-.5*(Math.sin(u*l)+1))}for(var d=1;d<r.length/3-1;d++)i.push(d),i.push(d+1),o.push(0),o.push(d),o.push(d+1),d==r.length/3-2&&(i.push(r.length/3-1),i.push(1),o.push(0),o.push(1),o.push(r.length/3-1));return{vertices:r,positions:r,normals:a,indices:o,cIndices:i,uvs:s}}Object.defineProperty(n,"__esModule",{value:!0}),n.Quad=r,n.Cube=o,n.Circle=i},{}],16:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Raycast=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement"),u=t("ray-sphere-intersection"),l=(t("ray-triangle-intersection"),t("ray-plane-intersection"));n.Raycast=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._camera=null,n._origin=vec3.create(),n._dir=vec3.create(),n._point=vec3.create(),n.length=10,n._matrixStack=[],n}return i(e,t),a(e,[{key:"setFromCamera",value:function(t,e){this._camera=t;var n=vec4.create();n[0]=e[0]/(this.context.renderer.width*window.devicePixelRatio*this.context.renderer.resolution)*2-1,n[1]=1-e[1]/(this.context.renderer.height*window.devicePixelRatio*this.context.renderer.resolution)*2,n[2]=-1,n[3]=1;var r=vec4.create(),o=mat4.create();mat4.invert(o,t.pMatrix),vec4.transformMat4(r,n,o),r[2]=-1,r[3]=0;var i=vec4.create(),a=mat4.create();mat4.invert(a,t.vMatrix),vec4.transformMat4(i,r,a);var s=vec3.fromValues(i[0],i[1],i[2]);vec3.normalize(s,s),this._dir=vec3.clone(s),this._origin=vec3.clone(t.position),vec3.multiply(s,s,vec3.fromValues(this.length,this.length,this.length));var u=vec3.create();vec3.add(u,t.position,s),this._point=vec3.clone(u)}},{key:"intersections",value:function(t){var e=[];switch(_mesh.colliderType){case"Points":for(var n=0;n<_mesh.geometry.bufferAttributes.position.data.length;n+=3){mat4.create();var r={},o=vec3.fromValues(_mesh.geometry.bufferAttributes.position.data[n+0],_mesh.geometry.bufferAttributes.position.data[n+1],_mesh.geometry.bufferAttributes.position.data[n+2]),i=.1;_mesh.geometry.bufferAttributes.normal.data.length>0&&(i=.0037*_mesh.geometry.bufferAttributes.normal.data[n]),u(r,this._origin,this._dir,o,i),r[0]&&e.push({index:n/3,vertex:o})}break;case"Triangles":case"BoundingSphere":case"BoundingBox":break;case"CustomSphere":if(!_numShapes)return void console.error("_numShapes not defined");for(var a=_mesh.geometry.bufferAttributes.index.data.length/_numShapes,s=_mesh.geometry.bufferAttributes.index.data.length-a;s>=0;s-=a){var l={},c=3*_mesh.geometry.bufferAttributes.index.data[s],f=_mesh.geometry.bufferAttributes.position.data,h=vec3.fromValues(f[c+0],f[c+1],f[c+2]),d=vec3.fromValues(f[c+3],f[c+4],f[c+5]);vec3.transformMat4(h,h,_mesh.modelMatrix),vec3.transformMat4(d,d,_mesh.modelMatrix);var m=vec3.create();m=vec3.subtract(m,h,d);var _=(m=vec3.length(m))*Math.cos(Math.PI/4);if(u(l,this._origin,this._dir,h,_),Object.keys(l).length>0){var x=vec3.create();vec3.subtract(x,h,this._origin),x=vec3.length(x),e.push({index:s/a,distance:x,center:h,point:vec3.fromValues(l[0],l[1],l[0])});break}}vec3.fromValues(_mesh.geometry.bufferAttributes.position.data[0],_mesh.geometry.bufferAttributes.position.data[1],_mesh.geometry.bufferAttributes.position.data[2])}return e}},{key:"planeIntersection",value:function(t,e){var n={};return l(n,this._origin,this._dir,t,e),vec3.fromValues(n[0],n[1],n[2])}},{key:"getPointFromCamera",value:function(t,e,n){return this.setFromCamera(t,e),this.planeIntersection(vec3.fromValues(0,0,-1),n||0)}},{key:"getPointinScreenSpace",value:function(t){}},{key:"pushMatrix",value:function(){}},{key:"popMatrix",value:function(){}},{key:"renderer",set:function(t){this._renderer=t},get:function(){return this._renderer}},{key:"camera",set:function(t){this._camera=t},get:function(){return this._camera}},{key:"length",set:function(t){this._length=t},get:function(){return this._length}},{key:"point",get:function(){return this._point}}]),e}(s.WebGlElement)},{"./WebGlElement":24,"ray-plane-intersection":38,"ray-sphere-intersection":39,"ray-triangle-intersection":40}],17:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Scene=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=(t("./ShaderProgram"),t("./Texture"),t("./WebGlElement"));n.Scene=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._matrixStack=[],n._currentCamera=null,n._mvMatrix=mat4.create(),n._childs=[],n._childsByName={},n._childsById={},n._opaqueObjects=[],n._transparentObjects=[],n._lastTime=(new Date).getTime(),n._elapsedTime=0,n}return i(e,t),a(e,[{key:"getChilds",value:function(){return this._childs}},{key:"getChildByName",value:function(t){return this._childsByName[t]}},{key:"getChildById",value:function(t){return this._childsById[t]}},{key:"add",value:function(t){this._childs.push(t),this._childsByName[t.name]=t,this._childsById[t.id]=t,"Mesh"==t.type&&(t.material.transparent?(this._transparentObjects.push(t),this._transparentObjects.sort(function(t,e){return t.material.zIndex-e.material.zIndex})):(this._opaqueObjects.push(t),this._opaqueObjects.sort(function(t,e){return t.material.zIndex-e.material.zIndex})))}},{key:"render",value:function(t){this._elapsedTime+=((new Date).getTime()-this._lastTime)/1e3,this._lastTime=(new Date).getTime();for(var e=0;e<this._opaqueObjects.length;e++)this._opaqueObjects[e].active&&this.renderObject(this._opaqueObjects[e],t);for(var n=0;n<this._transparentObjects.length;n++)this._transparentObjects[n].active&&this.renderObject(this._transparentObjects[n],t)}},{key:"renderObject",value:function(t,e){if(!e||"Camera"!=e.type)throw"Scene ERROR: You must pass a valid camera object as a parameter";if(t.material.ready){e.update(),mat4.identity(this._mvMatrix),mat4.multiply(this._mvMatrix,this._mvMatrix,e.vMatrix),this.pushMatrix(),mat4.multiply(this._mvMatrix,this._mvMatrix,t.modelMatrix),t.lookAtPoint&&(t.lookAtPoint=null),t.material.bind();var n=this._context.getUniformLocation(t.material.shaderProgram.program,"mv_Matrix");this._context.uniformMatrix4fv(n,this._context.FALSE,this._mvMatrix);var r=this._context.getUniformLocation(t.material.shaderProgram.program,"p_Matrix");if(this._context.uniformMatrix4fv(r,this._context.FALSE,e.pMatrix),t.material.uniforms)for(var o in t.material.uniforms){var i=this._context.getUniformLocation(t.material.shaderProgram.program,o);if(t.material.uniforms[o].type)switch(t.material.uniforms[o].type){case"float array":this._context.uniform1fv(i,t.material.uniforms[o].data);break;case"float":this._context.uniform1f(i,t.material.uniforms[o].data);break;case"int array":this._context.uniform1iv(i,t.material.uniforms[o].data);break;case"int":this._context.uniform1i(i,t.material.uniforms[o].data);break;case"vec2":this._context.uniform2fv(i,t.material.uniforms[o].data);break;case"vec3":this._context.uniform3fv(i,t.material.uniforms[o].data);break;case"vec4":this._context.uniform4fv(i,t.material.uniforms[o].data)}else console.error(this.constructor.name+" ERROR: the uniform: "+o+" has no type defined!")}var a=this._context.getUniformLocation(t.material.shaderProgram.program,"time");this._context.uniform1f(a,this._context.elapsedTime);var s=this._context.getUniformLocation(t.material.shaderProgram.program,"resolution");this._context.uniform2fv(s,vec2.fromValues(window.innerWidth,window.innerHeight)),t.material.depthTest?this._context.enable(this._context.DEPTH_TEST):this._context.disable(this._context.DEPTH_TEST),t.material.enableBlending?this._context.enable(this._context.BLEND):this._context.disable(this._context.BLEND),this._context.blendFunc(t.material.sourceBlendingMode,t.material.destinationBlendingMode),0!=t.geometry.bufferAttributes.position.data.length&&t.draw(),this.popMatrix()}}},{key:"pushMatrix",value:function(){if(this._matrixStack.length>20)throw'Scene ERROR: Invalid pushMatrix - Call "popMatrix" after "pushMatrix".';var t=mat4.create();mat4.copy(t,this._mvMatrix),this._matrixStack.push(t)}},{key:"popMatrix",value:function(){if(0==this._matrixStack.length)throw"Scene ERROR: Invalid popMatrix - Matrix stack is empty.";this._mvMatrix=this._matrixStack.pop()}}]),e}(s.WebGlElement)},{"./ShaderProgram":20,"./Texture":22,"./WebGlElement":24}],18:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.SdfGlyphAtlas=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement"),u=t("font-atlas-sdf");n.SdfGlyphAtlas=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._atlas=new u(t),n._textureContext=n._atlas.context,n}return i(e,t),a(e,[{key:"canvas",get:function(){return this._atlas.canvas}},{key:"elements",get:function(){return this._atlas.elements}}]),e}(s.WebGlElement)},{"./WebGlElement":24,"font-atlas-sdf":27}],19:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Shader=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement");n.Shader=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return t&&t.shaderType?(n._shader=n._context.createShader(t.shaderType),n.text=t.text,n):(console.error(n.type+" ERROR: a shader type must be defined! "),o(n))}return i(e,t),a(e,[{key:"shader",get:function(){return this._shader}},{key:"text",set:function(t){if(t)return this._text=t,this._context.shaderSource(this._shader,t),this._context.compileShader(this._shader),this._context.getShaderParameter(this._shader,this._context.COMPILE_STATUS)?void 0:(console.error("ERROR compiling vertex shader!",this._context.getShaderInfoLog(this._shader)),void console.error("LINE: "+this._context.getShaderInfoLog(this._shader).split(":")[2]+t.split("\n")[this._context.getShaderInfoLog(this._shader).split(":")[2]-1]))},get:function(){return this._text}}]),e}(s.WebGlElement)},{"./WebGlElement":24}],20:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.ShaderProgram=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=(t("./utils"),t("./WebGlElement"));n.ShaderProgram=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._program=null,n.vertexShader=t.vertexShader,n.fragmentShader=t.fragmentShader,n}return i(e,t),a(e,[{key:"link",value:function(t,e){this._program=this._context.createProgram(),this._context.bindAttribLocation(this._program,0,"position"),this._context.bindAttribLocation(this._program,1,"texCoord"),this._context.bindAttribLocation(this._program,2,"normal"),this._context.bindAttribLocation(this._program,3,"color"),this._context.bindAttribLocation(this._program,4,"customAttribute"),this._context.attachShader(this._program,t),this._context.attachShader(this._program,e),this._context.linkProgram(this._program),this._context.getProgramParameter(this._program,this._context.LINK_STATUS)?(this._context.validateProgram(this._program),this._context.getProgramParameter(this._program,this._context.VALIDATE_STATUS)||console.error("ERROR validating program!",this._context.getProgramInfoLog(this._program))):console.error("ERROR linking program!",this._context.getProgramInfoLog(this._program))}},{key:"bind",value:function(){this._context.boundProgram!=this._program&&(this._context.useProgram(this._program),this._context.boundProgram=this._program)}},{key:"unbind",value:function(){this._context.boundProgram!=this._program&&(this._context.useProgram(null),this._context.boundProgram=null)}},{key:"program",get:function(){return this._program}},{key:"vertexShader",set:function(t){t&&(this._vertexShader=t,this._fragmentShader&&this.link(this._vertexShader,this._fragmentShader))},get:function(){return this._vertexShader}},{key:"fragmentShader",set:function(t){t&&(this._fragmentShader=t,this._vertexShader&&this.link(this._vertexShader,this._fragmentShader))},get:function(){return this._fragmentShader}}]),e}(s.WebGlElement)},{"./WebGlElement":24,"./utils":42}],21:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Text=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./Mesh"),u=t("./P3D");n.Text=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n._type="Mesh",n.rotation=t.rotation||vec3.create(),n.position=t.position||vec3.create(),n.scale=t.scale||vec3.fromValues(1,1,1);var i=new u.P3D.BufferAttribute({context:n._context,name:"textInfo",data:new Float32Array([]),bufferType:n._context.ARRAY_BUFFER,attributeLocation:null,numberOfElements:4,dataType:n._context.FLOAT,normalisedElements:n._context.FALSE,sizeOfIndividualVertex:4,offsetFromBeginingVertex:0});return n.geometry=new u.P3D.Geometry({context:n._context}),n.geometry.addBufferAttribute(new u.P3D.BufferAttribute({context:n._context,name:"position",data:new Float32Array([])})),n.geometry.addBufferAttribute(new u.P3D.BufferAttribute({context:n._context,name:"texCoord",data:new Float32Array([])})),n.geometry.addBufferAttribute(new u.P3D.BufferAttribute({context:n._context,name:"index",data:new Uint16Array([])})),n.geometry.addBufferAttribute(i),n._debugGeometry=n.geometry.clone(),n._debugGeometry.bufferAttributes.index=new u.P3D.BufferAttribute({context:n._context,name:"index",data:new Uint16Array([])}),n._debugMesh=new u.P3D.Mesh({context:n._context,name:"debugMesh",geometry:n._debugGeometry,material:new u.P3D.MaterialHelper({context:n._context}).blackLines()}),n._debugMesh.position=n.position,n._debugMesh.rotation=n.rotation,n._debugMesh.scale=n.scale,n._content="",n.atlas=t.atlas||null,n.color=t.color||vec4.fromValues(1,0,0,1),n.lineHeight=t.lineHeight||1,n.align=t.align||"left",n.verticalAlign=t.verticalAlign||"top",n.letterSpacing=t.letterSpacing||0,n}return i(e,t),a(e,[{key:"write",value:function(t){this.atlas?(t+="",this._content=t,this.update()):console.error(this.constructor.name+" ERROR: You can not write without defining a GlyphAtlas ")}},{key:"update",value:function(){var t=0,e=0,n=[],r=[],o=0,i=[],a=[],s=[],l=this._content.split("<br>");this.material.uniforms.numLines={type:"float",data:l.length};switch(this.verticalAlign){case"top":0;break;case"center":.5*l.length;break;case"bottom":l.length}for(var c=0;c<l.length;c++){this.atlas.elements[l[c][0]];for(var f=0,h=0;h<l[c].length;h++){var d=this.atlas.elements[l[c][h]];f+=d.box.width/d.box.height+this.letterSpacing}switch(this.align){case"left":0;break;case"center":.5*f;break;case"right":f}for(var m=0;m<l[c].length;m++){var _=l[c][m],x=this.atlas.elements[_],p=x.box.width/x.box.height,v=new u.P3D.Quad([t+.5*p,0,0],[p,1,1]);t+=p+this.letterSpacing;for(var y=0;y<4;y++)r.push(f),r.push(c),r.push(m),r.push(l[c].length);for(var g=0;g<v.positions.length;g++)n.push(v.positions[g]);for(var b=0;b<v.indices.length;b++)a.push(v.indices[b]+o);for(var w=0;w<v.cIndices.length;w++)s.push(v.cIndices[w]+o);o=n.length/3;var T=[x.box.uvs.topLeft,x.box.uvs.topRight,x.box.uvs.bottomRight,x.box.uvs.bottomLeft];i.push(T=[].concat.apply([],T))}e-=this.lineHeight,t=0}i=[].concat.apply([],i),this.geometry.bufferAttributes.position.setData(new Float32Array(n),this._context.STATIC_DRAW),this.geometry.bufferAttributes.texCoord.setData(new Float32Array(i),this._context.STATIC_DRAW),this.geometry.bufferAttributes.textInfo.setData(new Float32Array(r),this._context.STATIC_DRAW),this.geometry.bufferAttributes.index.setData(new Uint16Array(a),this._context.STATIC_DRAW),this._debugGeometry.bufferAttributes.index.setData(new Uint16Array(s),this._context.STATIC_DRAW)}},{key:"clone",value:function(){new u.P3D.Text({context:this._context})}},{key:"atlas",set:function(t){t&&("GlyphAtlas"==t.type||"SdfGlyphAtlas"==t.type?(this.material||("GlyphAtlas"==t.type?(this.material=new u.P3D.MaterialHelper({context:this._context}).glyphs(),this.material.uniforms.solidColor={type:"vec4",data:vec4.fromValues(1,1,1,1)}):"SdfGlyphAtlas"==t.type&&(this.material=new u.P3D.MaterialHelper({context:this._context}).sdfGlyphs(),this.material.uniforms.solidColor={type:"vec4",data:vec4.fromValues(1,1,1,1)})),this._atlas=t,this.material.image=t.canvas):console.error(this.constructor.name+" ERROR: You must pass a valid GlyphAtlas "))},get:function(){return this._atlas}},{key:"color",set:function(t){this._color=t,this.material&&(this.material.uniforms.solidColor.data=t)},get:function(){return this._color}},{key:"lineHeight",set:function(t){this._lineHeight=t,this.material.uniforms.lineHeight={type:"float",data:t}},get:function(){return this._lineHeight}},{key:"align",set:function(t){switch(this._align=t,t){case"left":this.material.uniforms.alignMode={type:"float",data:0};break;case"center":this.material.uniforms.alignMode={type:"float",data:1};break;case"right":this.material.uniforms.alignMode={type:"float",data:2}}},get:function(){return this._align}},{key:"verticalAlign",set:function(t){switch(this._verticalAlign=t,t){case"top":this.material.uniforms.verticalAlignMode={type:"float",data:0};break;case"center":this.material.uniforms.verticalAlignMode={type:"float",data:1};break;case"bottom":this.material.uniforms.verticalAlignMode={type:"float",data:2}}},get:function(){return this._verticalAlign}},{key:"letterSpacing",set:function(t){this._letterSpacing=t,this.material.uniforms.letterSpacing={type:"float",data:t}},get:function(){return this._letterSpacing}},{key:"debugMesh",get:function(){return this._debugMesh}},{key:"content",get:function(){return this._content}}]),e}(s.Mesh)},{"./Mesh":11,"./P3D":13}],22:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Texture=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement");n.Texture=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.filter=t.filter||n._context.LINEAR,n.format=t.format||n._context.RGBA,n.textureType=t.type||n._context.UNSIGNED_BYTE,n.minFilter=t.minFilter||n._context.LINEAR,n.maxFilter=t.maxFilter||n._context.LINEAR,n.custom=t.custom||!1,n.texture=t.texture||null,n.width=t.width||null,n.height=t.height||null,n.image=t.image||null,n}return i(e,t),a(e,[{key:"createTexture",value:function(t,e,n){this.custom||(this._texture&&this._context.deleteTexture(this._texture),this._texture=this._context.createTexture(),this.bind(),this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_WRAP_S,this._context.CLAMP_TO_EDGE),this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_WRAP_T,this._context.CLAMP_TO_EDGE),this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_MIN_FILTER,this.minFilter),this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_MAG_FILTER,this.maxFilter),t?this._context.texImage2D(this._context.TEXTURE_2D,0,this._context.RGBA,this._context.RGBA,this._context.UNSIGNED_BYTE,t):this._context.texImage2D(this._context.TEXTURE_2D,0,this._context.RGBA,e,n,0,this._context.RGBA,this._context.UNSIGNED_BYTE,null),this.unbind())}},{key:"bind",value:function(){this._context.boundTexture!=this&&(this._context.boundTexture=this,this._context.bindTexture(this._context.TEXTURE_2D,this._texture))}},{key:"unbind",value:function(){this._context.boundTexture=null,this._context.bindTexture(this._context.TEXTURE_2D,null)}},{key:"update",value:function(){this.bind(),this._context.texImage2D(this._context.TEXTURE_2D,0,this._context.RGBA,this._context.RGBA,this._context.UNSIGNED_BYTE,this._image),this.unbind()}},{key:"activeTexture",value:function(t){this._context.activeTexture(t)}},{key:"width",set:function(t){t&&t!=this._width&&(this._width=t,null!=this.height&&null!=this.width&&this.createTexture(this.image,this.width,this.height))},get:function(){return this._width}},{key:"height",set:function(t){t&&t!=this._height&&(this._height=t,null!=this.height&&null!=this.width&&this.createTexture(this.image,this.width,this.height))},get:function(){return this._height}},{key:"image",set:function(t){t&&(this._image=t,this._texture?(this.bind(),this._context.texImage2D(this._context.TEXTURE_2D,0,this._context.RGBA,this._context.RGBA,this._context.UNSIGNED_BYTE,t),this.unbind()):this.createTexture(t,this.width,this.height))},get:function(){return this._image}},{key:"filter",set:function(t){this._filter=t},get:function(){return this._filter}},{key:"texture",set:function(t){this._texture=t},get:function(){return this._texture}},{key:"isLoaded",get:function(){return this._isLoaded}}]),e}(s.WebGlElement)},{"./WebGlElement":24}],23:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(n,"__esModule",{value:!0}),n.Transform=void 0;var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=t("./WebGlElement");n.Transform=function(t){function e(t){r(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n._position=vec3.create(),n._rotation=vec3.create(),n._scale=vec3.fromValues(1,1,1),n._lookAtPoint=null,n}return i(e,t),a(e,[{key:"lookAt",value:function(t){this._lookAtPoint=t}},{key:"position",set:function(t){this._position=t},get:function(){return this._position}},{key:"rotation",set:function(t){this._rotation=t},get:function(){return this._rotation}},{key:"scale",set:function(t){this._scale=t},get:function(){return this._scale}},{key:"lookAtPoint",set:function(t){this._lookAtPoint=t},get:function(){return this._lookAtPoint}}]),e}(s.WebGlElement)},{"./WebGlElement":24}],24:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.WebGlElement=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=t("./utils");n.WebGlElement=function(){function t(e){r(this,t),e&&e.context?(this._context=e.context,this._type=this.constructor.name,this._name=e.name||null,this._id=(0,i.guid)(),this.active=e.active||!0):console.error(this.constructor.name+" ERROR: webgl context must be defined! ")}return o(t,[{key:"log",value:function(t){}},{key:"logError",value:function(t){}},{key:"logWarn",value:function(t){}},{key:"context",set:function(t){this._context=t},get:function(){return this._context}},{key:"type",get:function(){return this._type}},{key:"name",set:function(t){this._name=t},get:function(){return this._name}},{key:"id",get:function(){return this._id}},{key:"active",set:function(t){this._active=t},get:function(){return this._active}}]),t}()},{"./utils":42}],25:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0}),n.WebGlRenderer=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t("./utils"),n.WebGlRenderer=function(){function t(e){r(this,t),this._options=e||{},this._type="WebGlRenderer",this.canvas=this._options.canvas||null,this.resolution=this._options.resolution||1,this.width=this._options.width||window.innerWidth,this.height=this._options.height||window.innerHeight,this.context=this._options.context,this.webglVersion=this._options.webglVersion,this.elapsedTime=null,this.deltaTime=null}return o(t,[{key:"createContext",value:function(){if(this._canvas){for(var t=["webgl","experimental-webgl"],e=0;e<t.length;e++)if(this._context=this._canvas.getContext(t[e],{premultipliedAlpha:!1,alpha:!1,antialias:!0}),this._context){this.setCustomGlFunctions(),console.log("WebGlRenderer: "+t[e]+" context created!"),this.addExtentions(),this.webglVersion=t[e];break}return this._context?this._context:(console.error("Your browser doesn't support WebGl"),void alert("Your browser doesn't support WebGl"))}return void console.error("WebGlRenderer ERROR: canvas is not defined!")}},{key:"addExtentions",value:function(){console.log("* EXTENTIONS *");for(var t=["OES_vertex_array_object","OES_texture_float","OES_standard_derivatives"],e=["MAX_VERTEX_TEXTURE_IMAGE_UNITS"],n=0;n<t.length;n++){var r=this._context.getExtension(t[n]);r?(this._context[t[n]]=r,console.log(t[n]+" enabled!")):console.error("WebGlRenderer ERROR: "+t[n]+" not supported!")}for(var o=0;o<e.length;o++)0==this._context.getParameter(this._context[e[o]])?console.warn("WebGlRenderer WARNING: "+e[o]+" not supported!"):console.log(e[o]+" supported!")}},{key:"setCustomGlFunctions",value:function(){this._context&&(this._context.renderer=this,this._context.resolution=this._resolution,this._context.realToCSSPixels=window.devicePixelRatio)}},{key:"setViewport",value:function(t,e,n,r){this.viewport={x:t,y:e,width:n,height:r},this._context.viewport(t,e,n,r)}},{key:"type",get:function(){return this._type}},{key:"webglVersion",set:function(t){t&&(this._webglVersion=t)},get:function(){return this._webglVersion}},{key:"canvas",set:function(t){t&&(this._canvas=t,this.width=t.width,this.height=t.height)},get:function(){return this._canvas}},{key:"width",set:function(t){t&&(this._width=t,this.canvas.width=this._width*window.devicePixelRatio*this._resolution,this.setCustomGlFunctions())},get:function(){return this._width}},{key:"realWidth",get:function(){return this._width*window.devicePixelRatio*this._resolution}},{key:"height",set:function(t){t&&(this._height=t,this.canvas.height=this._height*window.devicePixelRatio*this._resolution,this.setCustomGlFunctions())},get:function(){return this._height}},{key:"realHeight",get:function(){return this._height*window.devicePixelRatio*this._resolution}},{key:"realToCSSPixels",set:function(t){this._realToCSSPixels=t,this.setCustomGlFunctions()},get:function(){return this._realToCSSPixels}},{key:"resolution",set:function(t){this._resolution=t,this.setCustomGlFunctions()},get:function(){return this._resolution}},{key:"elapsedTime",set:function(t){this._elapsedTime=t},get:function(){return this._elapsedTime}},{key:"deltaTime",set:function(t){this._deltaTime=t},get:function(){return this._deltaTime}}]),t}()},{"./utils":42}],26:[function(t,e,n){},{}],27:[function(t,e,n){"use strict";function r(t){var e,n,r=(t=t||{}).canvas||document.createElement("canvas"),i=t.family||"monospace",a=t.shape||[512,512],s=t.step||[32,32],u=t.size||16,l=t.chars||[32,255],c=Math.floor((s[0]-u)/2),f=t.radius||1.5*c,h=new o(u,c,f,0,i),d=t.align||!0;if("number"==typeof u&&(u+="px"),Array.isArray(l)){if(2===l.length&&"number"==typeof l[0]&&"number"==typeof l[1]){var m=[];for(e=l[0],n=0;e<=l[1];e++)m[n++]=String.fromCharCode(e);l=m}}else l=String(l).split("");a=a.slice(),r.width=a[0],r.height=a[1];var _=r.getContext("2d");_.fillStyle="#000",_.fillRect(0,0,r.width,r.height),_.font=u+" "+i,_.textBaseline="bottom";var x=0,p=0,v={},y=Math.min(l.length,Math.floor(a[0]/s[0])*Math.ceil(a[1]/s[1])),g=h.ctx.textAlign,b=h.buffer;for(h.ctx.textAlign="center",h.buffer=h.size/2,e=0;e<y;e++){var w=h.draw(l[e]),T=0;d&&(T=function(t){var e,n,r,o=t.data,i=t.width,a=t.height,s=0,u=0;for(n=0;n<a;n++){for(r=n*i*4,e=0;e<i;e++)if(o[r+4*e]>0){s=n;break}if(s)break}for(n=a;n--;){for(r=n*i*4,e=0;e<i;e++)if(o[r+4*e]>0){u=n;break}if(u)break}return s-.5*(s+(a-u))}(w)),_.putImageData(w,x,p-T);var C=s[0],A=_.measureText(l[e]).width;v[l[e]]={x:x-0,y:p-0,width:s[0],height:s[1],uvs:{topLeft:[x/a[0],p/a[1]],topRight:[(x-_.measureText(l[e]).width)/a[0],p/a[1]],bottomRight:[(x-_.measureText(l[e]).width)/a[0],(p+s[1])/a[1]],bottomLeft:[x/a[0],(p+s[1])/a[1]]},box:{shape:a,x:x,y:p,width:_.measureText(l[e]).width,height:s[1],uvs:{topLeft:[(x+.5*C-.5*A)/a[0],p/a[1]],topRight:[(x-.5*C+.5*A+s[0])/a[0],p/a[1]],bottomRight:[(x-.5*C+.5*A+s[0])/a[0],(p+s[1])/a[1]],bottomLeft:[(x+.5*C-.5*A)/a[0],(p+s[1])/a[1]]}}},(x+=s[0])>a[0]-s[0]&&(x=0,p+=s[1])}return h.ctx.textAlign=g,h.buffer=b,{canvas:r,elements:v,context:_}}var o=t("tiny-sdf");e.exports=r},{"tiny-sdf":41}],28:[function(t,e,n){function r(t){var e=(t=t||{}).canvas||document.createElement("canvas"),n=t.family||"monospace",r=t.shape||[512,512],i=t.step||[32,32],a=t.size||16,s=t.chars||o;if("number"==typeof a&&(a+="px"),Array.isArray(s)){if(2===s.length&&"number"==typeof s[0]&&"number"==typeof s[1]){for(var u=[],l=s[0],c=0;l<=s[1];l++)u[c++]=String.fromCharCode(l);s=u}}else s=String(s).split("");r=r.slice(),e.width=r[0],e.height=r[1];var f=e.getContext("2d");f.fillStyle="rgba(0.0, 0.0, 0.0, 0.0)",f.fillRect(0,0,e.width,e.height),f.font=a+" "+n,f.textAlign="center",f.textBaseline="middle",f.fillStyle="#fff";for(var h={},d=i[0]/2,m=i[1]/2,_=d,x=m,l=0;l<s.length;l++)h[s[l]]={x:d-_,y:m-x,width:i[0],height:i[1],uvs:{topLeft:[(d-_)/r[0],(m-x)/r[1]],topRight:[(d-_+i[0])/r[0],(m-x)/r[1]],bottomRight:[(d-_+i[0])/r[0],(m-x+i[1])/r[1]],bottomLeft:[(d-_)/r[0],(m-x+i[1])/r[1]]},box:{shape:r,x:d-.5*f.measureText(s[l]).width,y:m-.5*i[1],width:f.measureText(s[l]).width,height:i[1],uvs:{topLeft:[(d-.5*f.measureText(s[l]).width)/r[0],(m-.5*i[1])/r[1]],topRight:[(d-.5*f.measureText(s[l]).width+f.measureText(s[l]).width)/r[0],(m-.5*i[1])/r[1]],bottomRight:[(d-.5*f.measureText(s[l]).width+f.measureText(s[l]).width)/r[0],(m-.5*i[1]+i[1])/r[1]],bottomLeft:[(d-.5*f.measureText(s[l]).width)/r[0],(m-.5*i[1]+i[1])/r[1]]}}},f.fillText(s[l],d,m),(d+=i[0])>r[0]-i[0]/2&&(d=i[0]/2,m+=i[1]);return{canvas:e,context:f,elements:h}}var o=[32,255];e.exports=r},{}],29:[function(t,e,n){function r(){return{name:"",triangleVertices:[],hasUVs:!1,hasNormals:!1,needsReindexing:!1,positionOffset:0,uvOffset:0,normalOffset:0}}function o(t){for(var e=t.trim().split("\n"),n=null,o=[],i=[],a=[],s=[],u=0,l=e.length;u<l;u++){var c=e[u].replace(/[\s]+/," "),f=c.trim().split(" ");if("#"!=f[0][0]&&f[0])switch(f[0]){case"v":i.push([Number(f[1]),Number(f[2]),Number(f[3])]);break;case"vt":a.push([Number(f[1]),Number(f[2])]);break;case"vn":s.push([Number(f[1]),Number(f[2]),Number(f[3])]);break;case"f":n||((n=r()).positionOffset=i.length,n.uvOffset=a.length,n.normalOffset=s.length,o.push(n));for(var h=[],d=1;d<f.length;d++){var m=f[d].split("/"),_=m[0],x=m[1],p=m[2];m[0]=_&&_.length>0?Number(_):null,m[1]=x&&x.length>0?Number(x):null,m[2]=p&&p.length>0?Number(p):null,h.push(m)}for(var v=1,y=h.length;v<y-1;v++)void 0!=h[0][1]&&(n.hasUVs=!0),void 0!=h[0][2]&&(n.hasNormals=!0),n.triangleVertices.push([h[0],h[v],h[v+1]]);break;case"g":(n=r()).positionOffset=i.length,n.uvOffset=a.length,n.normalOffset=s.length,n.name=c.slice(1).trim(),o.push(n);break;case"usemtl":case"mtllib":case"s":case"o":break;default:console.log("loadObj: skipping unrecognized line",c)}}for(var g=[],u=0,l=o.length;u<l;u++){var b={name:(n=o[u]).name,positions:[],uvs:n.hasUVs?[]:void 0,normals:n.hasNormals?[]:void 0,cells:[]};g.push(b);for(var w=[],T=0,C=0,A=0,E=n.triangleVertices.length;A<E;A++){for(var P=n.triangleVertices[A],O=[],v=0;v<3;v++){var M=P[v].join("-");void 0===(C=w[M])&&(C=T,w[M]=C,T++),O.push(C);var R=P[v][0];R=R>0?R-1:n.positionOffset+R;var S=P[v][1];S=S>0?S-1:n.uvOffset+S;var k=P[v][2];k=k>0?k-1:n.normalOffset+k,b.positions[C]=i[R],n.hasUVs&&(b.uvs[C]=a[S]),n.hasNormals&&(b.normals[C]=s[k])}b.cells.push(O)}}return g.length>1?g:g[0]}e.exports=o},{}],30:[function(t,e,n){function r(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}e.exports=r},{}],31:[function(t,e,n){function r(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}e.exports=r},{}],32:[function(t,e,n){function r(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],u=n[2];return t[0]=o*u-i*s,t[1]=i*a-r*u,t[2]=r*s-o*a,t}e.exports=r},{}],33:[function(t,e,n){function r(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}e.exports=r},{}],34:[function(t,e,n){function r(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}e.exports=r},{}],35:[function(t,e,n){function r(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}e.exports=r},{}],36:[function(t,e,n){function r(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return n*n+r*r+o*o}e.exports=r},{}],37:[function(t,e,n){function r(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}e.exports=r},{}],38:[function(t,e,n){function r(t,e,n,r,l){var c=o(n,r);if(0!==c){var f=-(o(e,r)+l)/c;return f<0?null:(a(u,n,f),i(t,e,u))}return o(r,e)+l===0?s(t,e):null}var o=t("gl-vec3/dot"),i=t("gl-vec3/add"),a=t("gl-vec3/scale"),s=t("gl-vec3/copy");e.exports=r;var u=[0,0,0]},{"gl-vec3/add":30,"gl-vec3/copy":31,"gl-vec3/dot":33,"gl-vec3/scale":34}],39:[function(t,e,n){function r(t,e,n,r,f){a(c,r,e);var h=i(n,c);if(h<0)return null;s(c,e,n,h);var d=o(r,c),m=f*f;return d>m?null:(u(t,n,h-Math.sqrt(m-d)),l(t,t,e))}var o=t("gl-vec3/squaredDistance"),i=t("gl-vec3/dot"),a=t("gl-vec3/subtract"),s=t("gl-vec3/scaleAndAdd"),u=t("gl-vec3/scale"),l=t("gl-vec3/add"),c=[0,0,0];e.exports=r},{"gl-vec3/add":30,"gl-vec3/dot":33,"gl-vec3/scale":34,"gl-vec3/scaleAndAdd":35,"gl-vec3/squaredDistance":36,"gl-vec3/subtract":37}],40:[function(t,e,n){function r(t,e,n,r){a(u,r[1],r[0]),a(l,r[2],r[0]),o(f,n,l);var d=i(u,f);if(d<s)return null;a(c,e,r[0]);var m=i(c,f);if(m<0||m>d)return null;o(h,c,u);var _=i(n,h);if(_<0||m+_>d)return null;var x=i(l,h)/d;return t[0]=e[0]+x*n[0],t[1]=e[1]+x*n[1],t[2]=e[2]+x*n[2],t}var o=t("gl-vec3/cross"),i=t("gl-vec3/dot"),a=t("gl-vec3/subtract"),s=1e-6,u=[0,0,0],l=[0,0,0],c=[0,0,0],f=[0,0,0],h=[0,0,0];e.exports=r},{"gl-vec3/cross":32,"gl-vec3/dot":33,"gl-vec3/subtract":37}],41:[function(t,e,n){"use strict";function r(t,e,n,r,o){this.fontSize=t||24,this.buffer=void 0===e?3:e,this.cutoff=r||.25,this.fontFamily=o||"sans-serif",this.radius=n||8;var i=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=i,this.ctx=this.canvas.getContext("2d"),this.ctx.font=t+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(i*i),this.gridInner=new Float64Array(i*i),this.f=new Float64Array(i),this.d=new Float64Array(i),this.z=new Float64Array(i+1),this.v=new Int16Array(i),this.middle=Math.round(i/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function o(t,e,n,r,o,a,s){for(var u=0;u<e;u++){for(var l=0;l<n;l++)r[l]=t[l*e+u];for(i(r,o,a,s,n),l=0;l<n;l++)t[l*e+u]=o[l]}for(l=0;l<n;l++){for(u=0;u<e;u++)r[u]=t[l*e+u];for(i(r,o,a,s,e),u=0;u<e;u++)t[l*e+u]=Math.sqrt(o[u])}}function i(t,e,n,r,o){n[0]=0,r[0]=-a,r[1]=+a;for(var i=1,s=0;i<o;i++){for(var u=(t[i]+i*i-(t[n[s]]+n[s]*n[s]))/(2*i-2*n[s]);u<=r[s];)s--,u=(t[i]+i*i-(t[n[s]]+n[s]*n[s]))/(2*i-2*n[s]);n[++s]=i,r[s]=u,r[s+1]=+a}for(i=0,s=0;i<o;i++){for(;r[s+1]<i;)s++;e[i]=(i-n[s])*(i-n[s])+t[n[s]]}}e.exports=r;var a=1e20;r.prototype.draw=function(t){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(t,this.buffer,this.middle);for(var e=this.ctx.getImageData(0,0,this.size,this.size),n=e.data,r=0;r<this.size*this.size;r++){var i=n[4*r+3]/255;this.gridOuter[r]=1===i?0:0===i?a:Math.pow(Math.max(0,.5-i),2),this.gridInner[r]=1===i?a:0===i?0:Math.pow(Math.max(0,i-.5),2)}for(o(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),o(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),r=0;r<this.size*this.size;r++){var s=this.gridOuter[r]-this.gridInner[r],u=Math.max(0,Math.min(255,Math.round(255-255*(s/this.radius+this.cutoff))));n[4*r+0]=u,n[4*r+1]=u,n[4*r+2]=u,n[4*r+3]=255}return e}},{}],42:[function(t,e,n){"use strict";function r(t,e,n){function r(t){var e=n.apply(this,arguments);return!1===e&&(t.stopPropagation(),t.preventDefault()),e}function o(){var e=n.call(t,window.event);return!1===e&&(window.event.returnValue=!1,window.event.cancelBubble=!0),e}return t.addEventListener?(t.addEventListener(e,r,!1),{elem:t,handler:r,event:e}):(t.attachEvent("on"+e,o),{elem:t,handler:o,event:e})}function o(t){t.elem.removeEventListener?t.elem.removeEventListener(t.event,t.handler):t.elem.detachEvent("on"+t.event,t.handler)}function i(t,e){var n=new XMLHttpRequest;n.open("GET",t,!0),n.onload=function(){n.status<200||n.status>299?e("Error: Http status"+n.status+" on resource "+t):e(null,n)},n.send()}function a(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function s(t,e,n){var r,o,i;if(0==e)r=o=i=n;else{var a=function(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+(e-t)*(2/3-n)*6:t},s=n<.5?n*(1+e):n+e-n*e,u=2*n-s;r=a(u,s,t+1/3),o=a(u,s,t),i=a(u,s,t-1/3)}return[r,o,i]}Object.defineProperty(n,"__esModule",{value:!0}),n.addEvent=r,n.removeEvent=o,n.ajax=i,n.guid=a,n.hslToRgb=s},{}]},{},[13]);